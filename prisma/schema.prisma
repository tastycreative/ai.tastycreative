generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                       String                    @id @default(cuid())
  clerkId                  String                    @unique
  email                    String?
  firstName                String?
  lastName                 String?
  imageUrl                 String?
  createdAt                DateTime                  @default(now())
  updatedAt                DateTime                  @updatedAt
  role                     UserRole                  @default(USER)
  instagramAccessToken     String?
  instagramAccountId       String?
  instagramTokenExpiry     DateTime?
  username                 String?
  coverImageUrl            String?
  currentOrganizationId    String?
  name                     String?
  avatarUrl                String?
  lastLoginAt              DateTime?
  isAdmin                  Boolean                   @default(false)
  feedPostBookmarks        FeedPostBookmark[]
  feedPostCommentLikes     FeedPostCommentLike[]
  feedPostComments         FeedPostComment[]
  feedPostLikes            FeedPostLike[]
  feedPosts                FeedPost[]
  fluxKontextConversations FluxKontextConversation[]
  images                   GeneratedImage[]
  videos                   GeneratedVideo[]
  jobs                     GenerationJob[]
  influencers              InfluencerLoRA[]
  instagramPosts           InstagramPost[]
  instagramProfiles        InstagramProfile[]
  notifications            Notification[]
  productionEntries        ProductionEntry[]
  referenceFolders         reference_folders[]
  referenceItems           reference_items[]
  teamMemberships          TeamMember[]
  trainingImages           TrainingImage[]
  trainingJobs             TrainingJob[]
  workspace_members        WorkspaceMember[]

  @@index([currentOrganizationId])
  @@map("users")
}

model InfluencerLoRA {
  id                 String            @id @default(cuid())
  clerkId            String
  name               String
  displayName        String
  fileName           String            @unique
  originalFileName   String
  fileSize           Int
  uploadedAt         DateTime          @default(now())
  updatedAt          DateTime          @updatedAt
  description        String?
  thumbnailUrl       String?
  cloudinaryUrl      String?
  cloudinaryPublicId String?
  isActive           Boolean           @default(true)
  usageCount         Int               @default(0)
  comfyUIPath        String?
  syncStatus         SyncStatus        @default(PENDING)
  lastUsedAt         DateTime?
  trainingJobId      String?
  profileId          String?
  user               User              @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  profile            InstagramProfile? @relation(fields: [profileId], references: [id])
  trainingJob        TrainingJob?      @relation(fields: [trainingJobId], references: [id])
  shares             LoRAShare[]

  @@index([clerkId])
  @@index([fileName])
  @@index([isActive])
  @@index([trainingJobId])
  @@index([profileId])
  @@map("influencer_loras")
}

model GenerationJob {
  id                     String           @id @default(cuid())
  clerkId                String
  status                 JobStatus        @default(PENDING)
  progress               Int?             @default(0)
  resultUrls             String[]         @default([])
  error                  String?
  type                   GenerationType   @default(TEXT_TO_IMAGE)
  createdAt              DateTime         @default(now())
  updatedAt              DateTime         @updatedAt
  lastChecked            DateTime?
  comfyUIPromptId        String?
  params                 Json?
  stage                  String?
  message                String?
  elapsedTime            Int?
  estimatedTimeRemaining Int?
  images                 GeneratedImage[]
  videos                 GeneratedVideo[]
  user                   User             @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)

  @@index([clerkId])
  @@index([status])
  @@index([type])
  @@index([createdAt])
  @@index([clerkId, createdAt])
  @@index([clerkId, status])
  @@index([clerkId, type])
  @@map("generation_jobs")
}

model GeneratedImage {
  id                    String                 @id @default(cuid())
  clerkId               String
  jobId                 String
  filename              String
  subfolder             String                 @default("")
  type                  String                 @default("output")
  fileSize              Int?
  width                 Int?
  height                Int?
  format                String?
  data                  Bytes?
  metadata              Json?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  networkVolumePath     String?
  s3Key                 String?
  awsS3Key              String?
  awsS3Url              String?
  googleDriveFileId     String?
  googleDriveFolderName String?
  googleDriveUploadedAt DateTime?
  loraModels            String[]               @default([])
  user                  User                   @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  job                   GenerationJob          @relation(fields: [jobId], references: [id], onDelete: Cascade)
  productionLinks       ProductionEntryImage[]

  @@unique([jobId, filename, subfolder, type])
  @@index([clerkId])
  @@index([jobId])
  @@index([clerkId, createdAt])
  @@index([format])
  @@index([filename])
  @@index([networkVolumePath])
  @@index([s3Key])
  @@index([awsS3Key])
  @@index([googleDriveFileId])
  @@index([loraModels])
  @@map("generated_images")
}

model GeneratedVideo {
  id                    String                 @id @default(cuid())
  clerkId               String
  jobId                 String
  filename              String
  subfolder             String                 @default("")
  type                  String                 @default("output")
  fileSize              Int?
  width                 Int?
  height                Int?
  duration              Float?
  fps                   Float?
  format                String?
  data                  Bytes?
  metadata              Json?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  networkVolumePath     String?
  s3Key                 String?
  awsS3Key              String?
  awsS3Url              String?
  googleDriveFileId     String?
  googleDriveFolderName String?
  googleDriveUploadedAt DateTime?
  user                  User                   @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  job                   GenerationJob          @relation(fields: [jobId], references: [id], onDelete: Cascade)
  productionLinks       ProductionEntryVideo[]

  @@unique([jobId, filename, subfolder, type])
  @@index([clerkId])
  @@index([jobId])
  @@index([clerkId, createdAt])
  @@index([format])
  @@index([filename])
  @@index([duration])
  @@index([fileSize])
  @@index([s3Key])
  @@index([googleDriveFileId])
  @@map("generated_videos")
}

model TrainingJob {
  id             String           @id @default(cuid())
  clerkId        String
  name           String
  description    String?
  status         TrainingStatus   @default(PENDING)
  progress       Int?             @default(0)
  currentStep    Int?             @default(0)
  totalSteps     Int?
  runpodJobId    String?
  runpodPodId    String?
  trainingConfig Json
  datasetConfig  Json
  modelConfig    Json
  sampleConfig   Json
  error          String?
  loss           Float?
  learningRate   Float?
  eta            String?
  sampleUrls     String[]         @default([])
  checkpointUrls String[]         @default([])
  finalModelUrl  String?
  logUrl         String?
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  startedAt      DateTime?
  completedAt    DateTime?
  resultingLoRAs InfluencerLoRA[]
  trainingImages TrainingImage[]
  user           User             @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)

  @@index([clerkId])
  @@index([status])
  @@index([clerkId, status])
  @@index([createdAt])
  @@index([runpodJobId])
  @@map("training_jobs")
}

model TrainingImage {
  id            String      @id @default(cuid())
  clerkId       String
  trainingJobId String
  filename      String
  caption       String?
  fileSize      Int?
  width         Int?
  height        Int?
  format        String?
  storageUrl    String
  localPath     String?
  uploadedAt    DateTime    @default(now())
  user          User        @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  trainingJob   TrainingJob @relation(fields: [trainingJobId], references: [id], onDelete: Cascade)

  @@unique([trainingJobId, filename])
  @@index([trainingJobId])
  @@index([clerkId])
  @@map("training_images")
}

model ProductionEntry {
  id              String                 @id @default(cuid())
  clerkId         String
  deadline        DateTime
  assignee        String
  influencer      String
  instagramSource String
  loraModel       String
  status          ProductionStatus       @default(PENDING)
  imagesTarget    Int                    @default(0)
  imagesGenerated Int                    @default(0)
  videosTarget    Int                    @default(0)
  videosGenerated Int                    @default(0)
  notes           String?
  createdAt       DateTime               @default(now())
  updatedAt       DateTime               @updatedAt
  user            User                   @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  linkedImages    ProductionEntryImage[]
  linkedVideos    ProductionEntryVideo[]

  @@index([clerkId])
  @@index([status])
  @@index([deadline])
  @@index([assignee])
  @@map("production_entries")
}

model InstagramPost {
  id                String                @id @default(cuid())
  clerkId           String
  driveFileId       String?
  driveFileUrl      String?
  fileName          String
  caption           String                @default("")
  scheduledDate     DateTime?
  status            InstagramPostStatus   @default(DRAFT)
  postType          PostType              @default(POST)
  folder            String
  order             Int                   @default(0)
  mimeType          String?
  createdAt         DateTime              @default(now())
  updatedAt         DateTime              @updatedAt
  rejectedAt        DateTime?
  rejectedBy        String?
  rejectionReason   String?
  commentsCount     Int?
  instagramUrl      String?
  lastMetricsUpdate DateTime?
  likesCount        Int?
  publishedAt       DateTime?
  awsS3Key          String?
  awsS3Url          String?
  originalFolder    String?
  profileId         String?
  pipelineItems     ContentPipelineItem[]
  user              User                  @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  profile           InstagramProfile?     @relation(fields: [profileId], references: [id])
  storySlots        StoryPlanningSlot[]   @relation("StorySlots")
  weeklySlots       WeeklyPlanningSlot[]

  @@index([clerkId])
  @@index([profileId])
  @@index([clerkId, profileId])
  @@index([clerkId, order])
  @@index([status])
  @@index([scheduledDate])
  @@index([driveFileId])
  @@index([awsS3Key])
  @@map("instagram_posts")
}

model Notification {
  id        String           @id @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  link      String?
  metadata  Json?
  read      Boolean          @default(false)
  readAt    DateTime?
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, read])
  @@index([createdAt])
  @@map("notifications")
}

model ProductionEntryImage {
  id                String          @id @default(cuid())
  productionEntryId String
  imageId           String
  createdAt         DateTime        @default(now())
  image             GeneratedImage  @relation(fields: [imageId], references: [id], onDelete: Cascade)
  productionEntry   ProductionEntry @relation(fields: [productionEntryId], references: [id], onDelete: Cascade)

  @@unique([productionEntryId, imageId])
  @@index([productionEntryId])
  @@index([imageId])
  @@map("production_entry_images")
}

model ProductionEntryVideo {
  id                String          @id @default(cuid())
  productionEntryId String
  videoId           String
  createdAt         DateTime        @default(now())
  productionEntry   ProductionEntry @relation(fields: [productionEntryId], references: [id], onDelete: Cascade)
  video             GeneratedVideo  @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([productionEntryId, videoId])
  @@index([productionEntryId])
  @@index([videoId])
  @@map("production_entry_videos")
}

model MultipartUploadSession {
  id             String   @id @default(cuid())
  sessionId      String   @unique
  clerkId        String
  uploadId       String
  s3Key          String
  uniqueFileName String
  totalParts     Int
  uploadedParts  Json     @default("[]")
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  expiresAt      DateTime

  @@index([sessionId])
  @@index([clerkId])
  @@index([expiresAt])
  @@map("multipart_upload_sessions")
}

model FluxKontextConversation {
  id        String               @id @default(cuid())
  clerkId   String
  title     String?
  createdAt DateTime             @default(now())
  updatedAt DateTime             @updatedAt
  user      User                 @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  messages  FluxKontextMessage[]

  @@index([clerkId])
  @@index([clerkId, updatedAt])
  @@map("flux_kontext_conversations")
}

model FluxKontextMessage {
  id             String                  @id @default(cuid())
  conversationId String
  role           MessageRole
  content        String
  imageData      String?
  createdAt      DateTime                @default(now())
  conversation   FluxKontextConversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  @@index([conversationId])
  @@index([conversationId, createdAt])
  @@map("flux_kontext_messages")
}

model FolderShare {
  id                String          @id @default(cuid())
  folderPrefix      String
  ownerClerkId      String
  sharedWithClerkId String
  permission        SharePermission @default(VIEW)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  sharedBy          String?
  note              String?

  @@unique([folderPrefix, sharedWithClerkId])
  @@index([ownerClerkId])
  @@index([sharedWithClerkId])
  @@index([folderPrefix])
  @@map("folder_shares")
}

model LoRAShare {
  id                String         @id @default(cuid())
  loraId            String
  ownerClerkId      String
  sharedWithClerkId String
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  sharedBy          String?
  note              String?
  lora              InfluencerLoRA @relation(fields: [loraId], references: [id], onDelete: Cascade)

  @@unique([loraId, sharedWithClerkId])
  @@index([ownerClerkId])
  @@index([sharedWithClerkId])
  @@index([loraId])
  @@map("lora_shares")
}

model InstagramProfile {
  id                     String                @id @default(cuid())
  clerkId                String
  name                   String
  description            String?
  instagramUsername      String?
  instagramAccountId     String?
  instagramAccessToken   String?
  instagramTokenExpiry   DateTime?
  isDefault              Boolean               @default(false)
  createdAt              DateTime              @default(now())
  updatedAt              DateTime              @updatedAt
  profileImageUrl        String?
  organizationId         String?
  modelBible             Json?
  captions               Caption[]
  bookmarks              FeedPostBookmark[]    @relation("ProfileBookmarks")
  commentLikes           FeedPostCommentLike[] @relation("ProfileCommentLikes")
  comments               FeedPostComment[]     @relation("ProfileComments")
  postLikes              FeedPostLike[]        @relation("ProfilePostLikes")
  feedPosts              FeedPost[]
  receivedFriendRequests Friendship[]          @relation("ReceivedFriendRequests")
  sentFriendRequests     Friendship[]          @relation("SentFriendRequests")
  linkedLoRAs            InfluencerLoRA[]
  posts                  InstagramPost[]
  user                   User                  @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  organization           Organization?         @relation(fields: [organizationId], references: [id])

  @@index([clerkId])
  @@index([clerkId, isDefault])
  @@index([organizationId])
  @@map("instagram_profiles")
}

model Friendship {
  id                String           @id @default(cuid())
  status            FriendshipStatus @default(PENDING)
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  receiverProfileId String
  senderProfileId   String
  receiverProfile   InstagramProfile @relation("ReceivedFriendRequests", fields: [receiverProfileId], references: [id], onDelete: Cascade)
  senderProfile     InstagramProfile @relation("SentFriendRequests", fields: [senderProfileId], references: [id], onDelete: Cascade)

  @@unique([senderProfileId, receiverProfileId])
  @@index([senderProfileId])
  @@index([receiverProfileId])
  @@index([senderProfileId, status])
  @@index([receiverProfileId, status])
  @@map("friendships")
}

model FeedPost {
  id        String             @id @default(cuid())
  userId    String
  caption   String
  createdAt DateTime           @default(now())
  updatedAt DateTime           @updatedAt
  imageUrls String[]
  mediaType String             @default("image")
  profileId String?
  bookmarks FeedPostBookmark[]
  comments  FeedPostComment[]
  likes     FeedPostLike[]
  profile   InstagramProfile?  @relation(fields: [profileId], references: [id])
  user      User               @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([profileId])
  @@index([createdAt])
  @@index([userId, createdAt])
  @@index([profileId, createdAt])
  @@map("feed_posts")
}

model FeedPostLike {
  id        String           @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime         @default(now())
  profileId String
  post      FeedPost         @relation(fields: [postId], references: [id], onDelete: Cascade)
  profile   InstagramProfile @relation("ProfilePostLikes", fields: [profileId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, profileId])
  @@index([postId])
  @@index([userId])
  @@index([profileId])
  @@map("feed_post_likes")
}

model FeedPostComment {
  id              String                @id @default(cuid())
  postId          String
  userId          String
  content         String
  createdAt       DateTime              @default(now())
  updatedAt       DateTime              @updatedAt
  parentCommentId String?
  profileId       String?
  likes           FeedPostCommentLike[]
  parentComment   FeedPostComment?      @relation("CommentReplies", fields: [parentCommentId], references: [id], onDelete: Cascade)
  replies         FeedPostComment[]     @relation("CommentReplies")
  post            FeedPost              @relation(fields: [postId], references: [id], onDelete: Cascade)
  profile         InstagramProfile?     @relation("ProfileComments", fields: [profileId], references: [id])
  user            User                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([userId])
  @@index([profileId])
  @@index([postId, createdAt])
  @@index([parentCommentId])
  @@map("feed_post_comments")
}

model FeedPostCommentLike {
  id        String           @id @default(cuid())
  commentId String
  userId    String
  createdAt DateTime         @default(now())
  profileId String
  comment   FeedPostComment  @relation(fields: [commentId], references: [id], onDelete: Cascade)
  profile   InstagramProfile @relation("ProfileCommentLikes", fields: [profileId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, profileId])
  @@index([commentId])
  @@index([userId])
  @@index([profileId])
  @@map("feed_post_comment_likes")
}

model FeedPostBookmark {
  id        String           @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime         @default(now())
  profileId String
  post      FeedPost         @relation(fields: [postId], references: [id], onDelete: Cascade)
  profile   InstagramProfile @relation("ProfileBookmarks", fields: [profileId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, profileId])
  @@index([postId])
  @@index([userId])
  @@index([profileId])
  @@map("feed_post_bookmarks")
}

model MarketplaceModel {
  id             String            @id @default(cuid())
  name           String
  price          Float
  status         MarketplaceStatus @default(AVAILABLE)
  imageUrl       String
  category       String            @default("Premium")
  gallery        String[]          @default([])
  description    String
  included       String[]          @default([])
  usedFor        String[]          @default([])
  organizationId String?
  organization   Organization?     @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt

  @@index([status])
  @@index([createdAt])
  @@index([organizationId])
  @@map("marketplace_models")
}

model WeeklyPlanningSlot {
  id            String           @id @default(cuid())
  clerkId       String
  profileId     String?
  date          DateTime
  slotType      WeeklySlotType
  slotIndex     Int              @default(0)
  status        WeeklySlotStatus @default(PLANNING)
  linkedPostId  String?
  notes         String?
  hashtags      String[]         @default([])
  trendingAudio String?
  contentIdeas  String?
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  linkedPost    InstagramPost?   @relation(fields: [linkedPostId], references: [id])

  @@unique([clerkId, date, slotType, slotIndex])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([linkedPostId])
  @@map("weekly_planning_slots")
}

model ContentPipelineItem {
  id            String                @id @default(cuid())
  clerkId       String
  contentId     String                @unique
  title         String
  contentType   ContentType
  status        PipelineStatus        @default(IDEA)
  linkedPostId  String?
  notes         String?
  ideaDate      DateTime?
  filmingDate   DateTime?
  editingDate   DateTime?
  reviewDate    DateTime?
  approvedDate  DateTime?
  scheduledDate DateTime?
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  dateCreated   DateTime?
  datePosted    DateTime?
  linkedPost    InstagramPost?        @relation(fields: [linkedPostId], references: [id])
  feedPostSlot  FeedPostPlanningSlot? @relation("FeedPostPipeline")
  reelSlot      ReelPlanningSlot?     @relation("ReelPipeline")
  storySlot     StoryPlanningSlot?

  @@index([clerkId])
  @@index([status])
  @@index([clerkId, status])
  @@index([contentType])
  @@index([linkedPostId])
  @@map("content_pipeline_items")
}

model StoryPlanningSlot {
  id                 String               @id @default(cuid())
  clerkId            String
  profileId          String?
  date               DateTime
  storyType          StoryType
  interactiveElement InteractiveElement?
  linkedPostId       String?
  notes              String?
  caption            String?
  hashtags           String[]             @default([])
  isPosted           Boolean              @default(false)
  postedAt           DateTime?
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt
  awsS3Key           String?
  awsS3Url           String?
  fileName           String?
  mimeType           String?
  contentId          String?              @unique
  pipelineItemId     String?              @unique
  timeSlot           DateTime?
  linkedPost         InstagramPost?       @relation("StorySlots", fields: [linkedPostId], references: [id])
  pipelineItem       ContentPipelineItem? @relation(fields: [pipelineItemId], references: [id])

  @@unique([clerkId, profileId, timeSlot])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([linkedPostId])
  @@index([pipelineItemId])
  @@index([contentId])
  @@map("story_planning_slots")
}

model ReelPlanningSlot {
  id             String               @id @default(cuid())
  clerkId        String
  profileId      String?
  contentId      String?              @unique
  pipelineItemId String?              @unique
  date           DateTime
  timeSlot       DateTime?
  reelType       ReelType
  hookIdea       String?
  trendingAudio  String?
  awsS3Key       String?
  awsS3Url       String?
  fileName       String?
  mimeType       String?
  notes          String?
  caption        String?
  hashtags       String[]             @default([])
  isPosted       Boolean              @default(false)
  postedAt       DateTime?
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  pipelineItem   ContentPipelineItem? @relation("ReelPipeline", fields: [pipelineItemId], references: [id])

  @@unique([clerkId, profileId, timeSlot])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([pipelineItemId])
  @@index([contentId])
  @@map("reel_planning_slots")
}

model FeedPostPlanningSlot {
  id             String               @id @default(cuid())
  clerkId        String
  profileId      String?
  contentId      String?              @unique
  pipelineItemId String?              @unique
  date           DateTime
  timeSlot       DateTime?
  postType       FeedPostType
  caption        String?
  hashtags       String[]             @default([])
  location       String?
  collaborators  String[]             @default([])
  notes          String?
  isPosted       Boolean              @default(false)
  postedAt       DateTime?
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  files          Json?
  pipelineItem   ContentPipelineItem? @relation("FeedPostPipeline", fields: [pipelineItemId], references: [id])

  @@unique([clerkId, profileId, timeSlot])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([pipelineItemId])
  @@index([contentId])
  @@map("feed_post_planning_slots")
}

model PerformanceMetric {
  id              String   @id @default(cuid())
  clerkId         String
  profileId       String   @default("")
  date            DateTime @db.Date
  reelsPosted     Int      @default(0)
  storiesPosted   Int      @default(0)
  feedPostsPosted Int      @default(0)
  totalViews      Int      @default(0)
  totalLikes      Int      @default(0)
  totalComments   Int      @default(0)
  totalShares     Int      @default(0)
  totalSaves      Int      @default(0)
  storyViews      Int      @default(0)
  storyReplies    Int      @default(0)
  followersStart  Int      @default(0)
  followersEnd    Int      @default(0)
  followersGained Int      @default(0)
  followersLost   Int      @default(0)
  engagementRate  Float?
  averageViews    Float?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@unique([clerkId, date, profileId])
  @@index([clerkId, date])
  @@map("performance_metrics")
}

model WorkflowPhase {
  id          String              @id @default(cuid())
  clerkId     String
  name        String
  description String?
  icon        String              @default("Circle")
  color       String              @default("blue")
  order       Int
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
  profileId   String              @default("")
  items       WorkflowCheckItem[]

  @@index([clerkId])
  @@index([clerkId, profileId])
  @@index([clerkId, order])
  @@map("workflow_phases")
}

model WorkflowCheckItem {
  id        String        @id @default(cuid())
  phaseId   String
  text      String
  order     Int
  checked   Boolean       @default(false)
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
  phase     WorkflowPhase @relation(fields: [phaseId], references: [id], onDelete: Cascade)

  @@index([phaseId])
  @@index([phaseId, order])
  @@map("workflow_check_items")
}

model HashtagSet {
  id          String   @id @default(cuid())
  clerkId     String
  name        String
  category    String
  description String?
  icon        String   @default("Hash")
  color       String   @default("blue")
  hashtags    String[]
  order       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([clerkId])
  @@index([clerkId, order])
  @@map("hashtag_sets")
}

model VaultFolder {
  id        String             @id @default(cuid())
  clerkId   String
  profileId String
  name      String
  createdAt DateTime           @default(now())
  updatedAt DateTime           @updatedAt
  isDefault Boolean            @default(false)
  shares    VaultFolderShare[]
  items     VaultItem[]

  @@index([clerkId])
  @@index([profileId])
  @@index([clerkId, profileId])
  @@map("vault_folders")
}

model VaultFolderShare {
  id                String          @id @default(cuid())
  vaultFolderId     String
  ownerClerkId      String
  sharedWithClerkId String
  permission        SharePermission @default(VIEW)
  sharedBy          String?
  note              String?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  folder            VaultFolder     @relation(fields: [vaultFolderId], references: [id], onDelete: Cascade)

  @@unique([vaultFolderId, sharedWithClerkId])
  @@index([ownerClerkId])
  @@index([sharedWithClerkId])
  @@index([vaultFolderId])
  @@map("vault_folder_shares")
}

model VaultItem {
  id        String      @id @default(cuid())
  clerkId   String
  profileId String
  folderId  String
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  awsS3Key  String
  awsS3Url  String
  fileName  String
  fileSize  Int
  fileType  String
  metadata  Json?
  folder    VaultFolder @relation(fields: [folderId], references: [id], onDelete: Cascade)

  @@index([clerkId])
  @@index([profileId])
  @@index([folderId])
  @@index([clerkId, profileId, folderId])
  @@index([awsS3Key])
  @@map("vault_items")
}

model Caption {
  id              String           @id @default(cuid())
  clerkId         String
  profileId       String
  caption         String
  captionCategory String
  captionTypes    String
  captionBanks    String
  usageCount      Int              @default(0)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  cooldownDays    Int              @default(7)
  isFavorite      Boolean          @default(false)
  lastUsedAt      DateTime?
  notes           String?
  tags            String?
  profile         InstagramProfile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@index([clerkId])
  @@index([profileId])
  @@index([clerkId, profileId])
  @@index([isFavorite])
  @@index([lastUsedAt])
  @@map("captions")
}

model SextingSet {
  id            String         @id @default(cuid())
  userId        String
  name          String
  category      String
  s3FolderPath  String
  status        String         @default("draft")
  scheduledDate DateTime?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  images        SextingImage[]

  @@index([userId])
  @@index([category])
  @@index([status])
  @@map("sexting_sets")
}

model SextingImage {
  id         String     @id @default(cuid())
  setId      String
  url        String
  name       String
  type       String
  sequence   Int
  size       Int
  uploadedAt DateTime   @default(now())
  set        SextingSet @relation(fields: [setId], references: [id], onDelete: Cascade)

  @@index([setId])
  @@index([sequence])
  @@map("sexting_images")
}

model SubscriptionPlan {
  id              String          @id @default(cuid())
  name            String          @unique
  displayName     String
  description     String?
  price           Float           @default(0)
  billingInterval BillingInterval @default(MONTHLY)
  maxMembers      Int             @default(1)
  maxProfiles     Int             @default(1)
  maxWorkspaces   Int             @default(0)
  maxStorageGB    Int             @default(5)
  monthlyCredits  Int             @default(100)
  stripePriceId   String?         @unique
  stripeProductId String?
  isActive        Boolean         @default(true)
  isPublic        Boolean         @default(true)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @default(now()) @updatedAt
  features        Json            @default("{}")
  organizations   Organization[]
  plan_features   plan_features[]

  @@index([isActive])
  @@index([isPublic])
  @@index([name])
  @@map("subscription_plans")
}

model Organization {
  id                   String                        @id @default(cuid())
  name                 String
  slug                 String                        @unique
  description          String?
  logoUrl              String?
  subscriptionPlanId   String?
  subscriptionStatus   SubscriptionStatus            @default(TRIAL)
  trialEndsAt          DateTime?
  currentPeriodStart   DateTime?
  currentPeriodEnd     DateTime?
  cancelAtPeriodEnd    Boolean                       @default(false)
  stripeCustomerId     String?                       @unique
  stripeSubscriptionId String?                       @unique
  billingEmail         String?
  billingName          String?
  billingAddress       Json?
  customMaxMembers     Int?
  customMaxProfiles    Int?
  customMaxWorkspaces  Int?
  customMaxStorageGB   Int?
  customMonthlyCredits Int?
  currentStorageGB     Float                         @default(0)
  creditsUsedThisMonth Int                           @default(0)
  lastCreditReset      DateTime?
  isActive             Boolean                       @default(true)
  createdAt            DateTime                      @default(now())
  updatedAt            DateTime                      @default(now()) @updatedAt
  customPermissions    CustomOrganizationPermission?
  instagramProfiles    InstagramProfile[]
  invites              OrganizationInvite[]
  marketplaceModels    MarketplaceModel[]
  subscriptionPlan     SubscriptionPlan?             @relation(fields: [subscriptionPlanId], references: [id])
  members              TeamMember[]
  usageLogs            UsageLog[]
  workspaces           Workspace[]

  @@index([slug])
  @@index([subscriptionPlanId])
  @@index([stripeCustomerId])
  @@index([isActive])
  @@map("organizations")
}

model TeamMember {
  id               String       @id @default(cuid())
  userId           String
  organizationId   String
  role             TeamRole     @default(MEMBER)
  canInviteMembers Boolean      @default(false)
  canManageBilling Boolean      @default(false)
  canManageMembers Boolean      @default(false)
  lastActiveAt     DateTime?
  invitedBy        String?
  joinedAt         DateTime     @default(now())
  createdAt        DateTime     @default(now())
  updatedAt        DateTime     @default(now()) @updatedAt
  organization     Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user             User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, organizationId])
  @@index([organizationId])
  @@index([userId])
  @@index([organizationId, role])
  @@map("team_members")
}

model OrganizationInvite {
  id             String       @id @default(cuid())
  organizationId String
  email          String
  role           TeamRole     @default(MEMBER)
  invitedBy      String
  token          String       @unique
  expiresAt      DateTime
  acceptedAt     DateTime?
  createdAt      DateTime     @default(now())
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@unique([organizationId, email])
  @@index([organizationId])
  @@index([token])
  @@index([email])
  @@map("organization_invites")
}

model CustomOrganizationPermission {
  id              String       @id @default(cuid())
  organizationId  String       @unique
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @default(now()) @updatedAt
  permissions     Json         @default("{}")
  maxVaultFolders Int?
  organization    Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@map("custom_organization_permissions")
}

model Workspace {
  id             String            @id @default(cuid())
  organizationId String
  name           String
  slug           String
  description    String?
  color          String?
  icon           String?
  isActive       Boolean           @default(true)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @default(now()) @updatedAt
  members        WorkspaceMember[]
  organization   Organization      @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@unique([organizationId, slug])
  @@index([organizationId])
  @@index([isActive])
  @@map("workspaces")
}

model WorkspaceMember {
  id          String    @id @default(cuid())
  workspaceId String
  userId      String
  role        TeamRole  @default(MEMBER)
  joinedAt    DateTime  @default(now())
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @default(now()) @updatedAt
  users       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  workspace   Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

  @@unique([workspaceId, userId])
  @@index([workspaceId])
  @@index([userId])
  @@map("workspace_members")
}

model UsageLog {
  id             String       @id @default(cuid())
  organizationId String
  userId         String
  workspaceId    String?
  action         String
  resource       String
  creditsUsed    Int          @default(0)
  metadata       Json?
  createdAt      DateTime     @default(now())
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@index([userId])
  @@index([organizationId, createdAt])
  @@index([createdAt])
  @@map("usage_logs")
}

model ai_voice_accounts {
  id                   String                 @id
  name                 String
  description          String?
  elevenlabsVoiceId    String                 @unique
  elevenlabsApiKey     String?
  previewUrl           String?
  category             String?
  gender               String?
  age                  String?
  accent               String?
  language             String?
  labels               Json?
  settings             Json?
  isActive             Boolean                @default(true)
  usageCount           Int                    @default(0)
  lastUsedAt           DateTime?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  createdBy            String
  ai_voice_generations ai_voice_generations[]

  @@index([category])
  @@index([createdBy])
  @@index([isActive])
}

model ai_voice_generations {
  id                String            @id
  userId            String
  voiceAccountId    String
  voiceName         String
  text              String
  characterCount    Int
  modelId           String
  outputFormat      String
  audioUrl          String?
  audioSize         Int?
  voiceSettings     Json?
  createdAt         DateTime          @default(now())
  ai_voice_accounts ai_voice_accounts @relation(fields: [voiceAccountId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([userId])
  @@index([voiceAccountId])
}

model reference_items {
  id           String             @id @default(cuid())
  clerkId      String
  name         String
  description  String?
  fileType     String
  mimeType     String
  fileSize     Int
  width        Int?
  height       Int?
  duration     Float?
  awsS3Key     String
  awsS3Url     String
  thumbnailUrl String?
  tags         String[]           @default([])
  usageCount   Int                @default(0)
  lastUsedAt   DateTime?
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
  folderId     String?
  isFavorite   Boolean            @default(false)
  user         User               @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  folder       reference_folders? @relation(fields: [folderId], references: [id])

  @@index([clerkId])
  @@index([clerkId, folderId])
  @@index([clerkId, isFavorite])
  @@index([fileType])
  @@index([lastUsedAt])
  @@index([folderId])
  @@index([tags])
  @@index([usageCount])
}

model reference_folders {
  id          String              @id @default(cuid())
  clerkId     String
  name        String
  description String?
  color       String              @default("#8B5CF6")
  icon        String              @default("folder")
  parentId    String?
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
  user        User                @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  parent      reference_folders?  @relation("FolderHierarchy", fields: [parentId], references: [id])
  children    reference_folders[] @relation("FolderHierarchy")
  items       reference_items[]

  @@unique([clerkId, name, parentId])
  @@index([clerkId])
  @@index([clerkId, parentId])
  @@index([parentId])
}

model of_model_assets {
  id           String           @id @default(cuid())
  creatorId    String
  type         OfModelAssetType
  name         String
  url          String
  thumbnailUrl String?
  fileSize     Int?
  mimeType     String?
  metadata     Json?
  createdAt    DateTime         @default(now())
  updatedAt    DateTime
  of_models    of_models        @relation(fields: [creatorId], references: [id], onDelete: Cascade)

  @@index([creatorId])
  @@index([type])
}

model of_model_details {
  id                   String    @id @default(cuid())
  creatorId            String    @unique
  fullName             String?
  age                  Int?
  birthday             DateTime?
  height               String?
  weight               String?
  ethnicity            String?
  timezone             String?
  currentCity          String?
  interests            String[]  @default([])
  favoriteColors       String[]  @default([])
  favoriteEmojis       String[]  @default([])
  contentOffered       String[]  @default([])
  customMinPrice       Float?
  videoCallMinPrice    Float?
  limitations          String[]  @default([])
  verbiageRestrictions String[]  @default([])
  amazonWishlist       String?
  onboardingCompleted  Boolean   @default(false)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  of_models            of_models @relation(fields: [creatorId], references: [id], onDelete: Cascade)

  @@index([creatorId])
}

model of_model_pricing_categories {
  id                     String                   @id @default(cuid())
  creatorId              String?
  name                   String
  slug                   String
  description            String?
  order                  Int                      @default(0)
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  isGlobal               Boolean                  @default(false)
  of_models              of_models?               @relation(fields: [creatorId], references: [id], onDelete: Cascade)
  of_model_pricing_items of_model_pricing_items[]

  @@unique([creatorId, slug])
  @@index([creatorId])
  @@index([isGlobal])
}

model of_model_pricing_items {
  id                          String                      @id @default(cuid())
  categoryId                  String
  name                        String
  price                       Float
  description                 String?
  order                       Int                         @default(0)
  isActive                    Boolean                     @default(true)
  createdAt                   DateTime                    @default(now())
  updatedAt                   DateTime
  isFree                      Boolean                     @default(false)
  priceMax                    Float?
  priceMin                    Float?
  priceType                   PricingItemType             @default(FIXED)
  of_model_pricing_categories of_model_pricing_categories @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  pricing_history             pricing_history[]

  @@index([categoryId])
  @@index([isFree])
  @@index([priceType])
}

model of_models {
  id                          String                        @id @default(cuid())
  name                        String
  displayName                 String
  slug                        String                        @unique
  status                      OfModelStatus                 @default(ACTIVE)
  profileImageUrl             String?
  bio                         String?
  personalityType             String?
  commonTerms                 String[]                      @default([])
  commonEmojis                String[]                      @default([])
  restrictedTerms             String[]                      @default([])
  notes                       String?
  percentageTaken             Float?
  guaranteedAmount            Float?
  launchDate                  DateTime?
  instagramUrl                String?
  twitterUrl                  String?
  tiktokUrl                   String?
  websiteUrl                  String?
  profileLinkUrl              String?
  referrerName                String?
  chattingManagers            String[]                      @default([])
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime
  createdBy                   String?
  of_model_assets             of_model_assets[]
  of_model_details            of_model_details?
  of_model_pricing_categories of_model_pricing_categories[]

  @@index([slug])
  @@index([status])
}

model plan_features {
  id                 String           @id
  planId             String
  featureKey         String
  featureValue       String
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @default(now())
  subscription_plans SubscriptionPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@unique([planId, featureKey])
  @@index([featureKey])
  @@index([planId])
}

model pricing_template {
  id          String                  @id @default(cuid())
  name        String
  slug        String                  @unique
  description String?
  category    PricingTemplateCategory
  pageType    PricingTemplatePageType @default(ALL_PAGES)
  isDefault   Boolean                 @default(false)
  isActive    Boolean                 @default(true)
  createdBy   String?
  createdAt   DateTime                @default(now())
  updatedAt   DateTime                @updatedAt
  items       pricing_template_item[]

  @@index([category])
  @@index([pageType])
  @@index([isActive])
}

model pricing_template_item {
  id          String           @id @default(cuid())
  templateId  String
  name        String
  priceType   PricingItemType  @default(FIXED)
  priceFixed  Float?
  priceMin    Float?
  priceMax    Float?
  description String?
  order       Int              @default(0)
  isActive    Boolean          @default(true)
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  isFree      Boolean          @default(false)
  template    pricing_template @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@index([templateId])
  @@index([order])
  @@index([isFree])
}

model pricing_history {
  id            String                 @id @default(cuid())
  pricingItemId String
  changeType    PricingChangeType
  oldName       String?
  oldPriceType  PricingItemType?
  oldPrice      Float?
  oldPriceMin   Float?
  oldPriceMax   Float?
  oldIsFree     Boolean?
  oldIsActive   Boolean?
  newName       String?
  newPriceType  PricingItemType?
  newPrice      Float?
  newPriceMin   Float?
  newPriceMax   Float?
  newIsFree     Boolean?
  newIsActive   Boolean?
  changedById   String?
  changedByName String?
  reason        String?
  createdAt     DateTime               @default(now())
  pricingItem   of_model_pricing_items @relation(fields: [pricingItemId], references: [id], onDelete: Cascade)

  @@index([pricingItemId])
  @@index([createdAt])
  @@index([changeType])
  @@index([changedById])
}

enum SyncStatus {
  PENDING
  SYNCED
  MISSING
  ERROR
}

enum JobStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum TrainingStatus {
  PENDING
  QUEUED
  INITIALIZING
  PROCESSING
  SAMPLING
  SAVING
  COMPLETED
  FAILED
  CANCELLED
  TIMEOUT
}

enum GenerationType {
  TEXT_TO_IMAGE
  IMAGE_TO_VIDEO
  IMAGE_TO_IMAGE
  TEXT_TO_VIDEO
  VIDEO_TO_VIDEO
  SKIN_ENHANCEMENT
  IMAGE_TO_IMAGE_SKIN_ENHANCEMENT
  FACE_SWAP
  VIDEO_FPS_BOOST
  FLUX_KONTEXT
}

enum UserRole {
  USER
  MANAGER
  ADMIN
  SUPER_ADMIN
  CONTENT_CREATOR
}

enum ProductionStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
}

enum InstagramPostStatus {
  DRAFT
  REVIEW
  APPROVED
  SCHEDULED
  PUBLISHED
  PENDING
}

enum NotificationType {
  POST_REMINDER
  POST_APPROVED
  POST_REJECTED
  SYSTEM
}

enum PostType {
  POST
  REEL
  STORY
}

enum SharePermission {
  VIEW
  EDIT
}

enum MessageRole {
  USER
  ASSISTANT
  SYSTEM
}

enum FriendshipStatus {
  PENDING
  ACCEPTED
  REJECTED
  BLOCKED
}

enum MarketplaceStatus {
  AVAILABLE
  SOLD
  RESERVED
}

enum WeeklySlotType {
  REEL_1
  REEL_2
  STORY_BATCH
  FEED_POST
}

enum WeeklySlotStatus {
  PLANNING
  IN_PROGRESS
  READY
  ASSIGNED
  POSTED
}

enum ContentType {
  REEL
  POST
  STORY
  CAROUSEL
  VIDEO
}

enum PipelineStatus {
  IDEA
  FILMING
  EDITING
  REVIEW
  APPROVED
  SCHEDULED
  POSTED
  ARCHIVED
}

enum StoryTimeSlot {
  SLOT_9AM
  SLOT_11AM
  SLOT_1PM
  SLOT_3PM
  SLOT_5PM
  SLOT_7PM
  SLOT_9PM
  SLOT_OTHER
}

enum StoryType {
  SELFIE
  BEHIND_SCENES
  PROMO
  PRODUCT
  GRWM
  OOTD
  QA
  TUTORIAL
  LIFESTYLE
  ANNOUNCEMENT
  USER_CONTENT
  OTHER
}

enum InteractiveElement {
  POLL
  SLIDER
  QUESTION
  QUIZ
  COUNTDOWN
  LINK
  MENTION
  HASHTAG
  LOCATION
  MUSIC
  NONE
}

enum ReelType {
  TRENDING
  TUTORIAL
  BEHIND_SCENES
  PROMO
  PRODUCT
  LIFESTYLE
  TRANSITION
  DAY_IN_LIFE
  CHALLENGE
  COMEDY
  EDUCATIONAL
  OTHER
}

enum FeedPostType {
  SINGLE_IMAGE
  CAROUSEL
  VIDEO
  ALBUM
}

enum BillingInterval {
  MONTHLY
  YEARLY
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  PAST_DUE
  CANCELLED
  EXPIRED
  PAUSED
}

enum TeamRole {
  OWNER
  ADMIN
  MANAGER
  CREATOR
  VIEWER
  MEMBER
}

enum ReferenceType {
  IMAGE
  VIDEO
}

enum OfModelAssetType {
  IMAGE
  VIDEO
  DOCUMENT
  AUDIO
  OTHER
}

enum OfModelStatus {
  ACTIVE
  INACTIVE
  DROPPED
  PENDING
}

enum PricingChangeType {
  CREATED
  UPDATED
  DELETED
  ACTIVATED
  DEACTIVATED
  PRICE_CHANGE
}

enum PricingTemplateCategory {
  PORN_ACCURATE
  PORN_SCAM
  GF_ACCURATE
  GF_SCAM
  BUNDLE_BASED
  CUSTOM
}

enum PricingTemplatePageType {
  ALL_PAGES
  FREE
  PAID
  VIP
}

enum PricingItemType {
  FIXED
  RANGE
  MINIMUM
}
