generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                       String                    @id @default(cuid())
  clerkId                  String                    @unique
  email                    String?
  firstName                String?
  lastName                 String?
  imageUrl                 String?
  createdAt                DateTime                  @default(now())
  updatedAt                DateTime                  @updatedAt
  role                     UserRole                  @default(USER)
  instagramAccessToken     String?
  instagramAccountId       String?
  instagramTokenExpiry     DateTime?
  username                 String?
  coverImageUrl            String?
  currentOrganizationId    String?
  name                     String?
  avatarUrl                String?
  lastLoginAt              DateTime?
  isAdmin                  Boolean                   @default(false)
  billingTransactions      BillingTransaction[]
  content_submissions      content_submissions[]
  creditUsageLogs          CreditUsageLog[]
  feedPostBookmarks        FeedPostBookmark[]
  feedPostCommentLikes     FeedPostCommentLike[]
  feedPostComments         FeedPostComment[]
  feedPostLikes            FeedPostLike[]
  feedPosts                FeedPost[]
  fluxKontextConversations FluxKontextConversation[]
  images                   GeneratedImage[]
  videos                   GeneratedVideo[]
  jobs                     GenerationJob[]
  influencers              InfluencerLoRA[]
  instagramPosts           InstagramPost[]
  instagramProfiles        InstagramProfile[]
  modelOnboardingDrafts    ModelOnboardingDraft[]
  notifications            Notification[]
  onboardingInvitations    OnboardingInvitation[]
  productionEntries        ProductionEntry[]
  referenceFolders         reference_folders[]
  referenceItems           reference_items[]
  teamMemberships          TeamMember[]
  trainingImages           TrainingImage[]
  trainingJobs             TrainingJob[]
  workspace_members        WorkspaceMember[]
  pinnedProfiles           ProfilePin[]

  @@index([currentOrganizationId])
  @@map("users")
}

model InfluencerLoRA {
  id                 String            @id @default(cuid())
  clerkId            String
  name               String
  displayName        String
  fileName           String            @unique
  originalFileName   String
  fileSize           Int
  uploadedAt         DateTime          @default(now())
  updatedAt          DateTime          @updatedAt
  description        String?
  thumbnailUrl       String?
  cloudinaryUrl      String?
  cloudinaryPublicId String?
  isActive           Boolean           @default(true)
  usageCount         Int               @default(0)
  comfyUIPath        String?
  syncStatus         SyncStatus        @default(PENDING)
  lastUsedAt         DateTime?
  trainingJobId      String?
  profileId          String?
  user               User              @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  profile            InstagramProfile? @relation(fields: [profileId], references: [id])
  trainingJob        TrainingJob?      @relation(fields: [trainingJobId], references: [id])
  shares             LoRAShare[]

  @@index([clerkId])
  @@index([fileName])
  @@index([isActive])
  @@index([trainingJobId])
  @@index([profileId])
  @@map("influencer_loras")
}

model GenerationJob {
  id                     String           @id @default(cuid())
  clerkId                String
  status                 JobStatus        @default(PENDING)
  progress               Int?             @default(0)
  resultUrls             String[]         @default([])
  error                  String?
  type                   GenerationType   @default(TEXT_TO_IMAGE)
  createdAt              DateTime         @default(now())
  updatedAt              DateTime         @updatedAt
  lastChecked            DateTime?
  comfyUIPromptId        String?
  params                 Json?
  stage                  String?
  message                String?
  elapsedTime            Int?
  estimatedTimeRemaining Int?
  images                 GeneratedImage[]
  videos                 GeneratedVideo[]
  user                   User             @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)

  @@index([clerkId])
  @@index([status])
  @@index([type])
  @@index([createdAt])
  @@index([clerkId, createdAt])
  @@index([clerkId, status])
  @@index([clerkId, type])
  @@map("generation_jobs")
}

model ActiveGeneration {
  id                     String         @id @default(cuid())
  clerkId                String
  jobId                  String         @unique
  generationType         GenerationType
  progress               Int            @default(0)
  stage                  String
  message                String
  status                 JobStatus      @default(PENDING)
  startedAt              DateTime       @default(now())
  completedAt            DateTime?
  elapsedTime            Int?
  estimatedTimeRemaining Int?
  metadata               Json?
  results                Json?
  error                  String?
  createdAt              DateTime       @default(now())
  updatedAt              DateTime       @updatedAt

  @@index([clerkId])
  @@index([status])
  @@index([generationType])
  @@index([clerkId, status])
  @@index([clerkId, generationType])
  @@index([startedAt])
  @@map("active_generations")
}

model GeneratedImage {
  id                    String                 @id @default(cuid())
  clerkId               String
  jobId                 String
  filename              String
  subfolder             String                 @default("")
  type                  String                 @default("output")
  fileSize              Int?
  width                 Int?
  height                Int?
  format                String?
  data                  Bytes?
  metadata              Json?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  networkVolumePath     String?
  s3Key                 String?
  awsS3Key              String?
  awsS3Url              String?
  googleDriveFileId     String?
  googleDriveFolderName String?
  googleDriveUploadedAt DateTime?
  loraModels            String[]               @default([])
  user                  User                   @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  job                   GenerationJob          @relation(fields: [jobId], references: [id], onDelete: Cascade)
  productionLinks       ProductionEntryImage[]

  @@unique([jobId, filename, subfolder, type])
  @@index([clerkId])
  @@index([jobId])
  @@index([clerkId, createdAt])
  @@index([format])
  @@index([filename])
  @@index([networkVolumePath])
  @@index([s3Key])
  @@index([awsS3Key])
  @@index([googleDriveFileId])
  @@index([loraModels])
  @@map("generated_images")
}

model GeneratedVideo {
  id                    String                 @id @default(cuid())
  clerkId               String
  jobId                 String
  filename              String
  subfolder             String                 @default("")
  type                  String                 @default("output")
  fileSize              Int?
  width                 Int?
  height                Int?
  duration              Float?
  fps                   Float?
  format                String?
  data                  Bytes?
  metadata              Json?
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  networkVolumePath     String?
  s3Key                 String?
  awsS3Key              String?
  awsS3Url              String?
  googleDriveFileId     String?
  googleDriveFolderName String?
  googleDriveUploadedAt DateTime?
  user                  User                   @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  job                   GenerationJob          @relation(fields: [jobId], references: [id], onDelete: Cascade)
  productionLinks       ProductionEntryVideo[]

  @@unique([jobId, filename, subfolder, type])
  @@index([clerkId])
  @@index([jobId])
  @@index([clerkId, createdAt])
  @@index([format])
  @@index([filename])
  @@index([duration])
  @@index([fileSize])
  @@index([s3Key])
  @@index([googleDriveFileId])
  @@map("generated_videos")
}

model TrainingJob {
  id             String           @id @default(cuid())
  clerkId        String
  name           String
  description    String?
  status         TrainingStatus   @default(PENDING)
  progress       Int?             @default(0)
  currentStep    Int?             @default(0)
  totalSteps     Int?
  runpodJobId    String?
  runpodPodId    String?
  trainingConfig Json
  datasetConfig  Json
  modelConfig    Json
  sampleConfig   Json
  error          String?
  loss           Float?
  learningRate   Float?
  eta            String?
  sampleUrls     String[]         @default([])
  checkpointUrls String[]         @default([])
  finalModelUrl  String?
  logUrl         String?
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  startedAt      DateTime?
  completedAt    DateTime?
  resultingLoRAs InfluencerLoRA[]
  trainingImages TrainingImage[]
  user           User             @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)

  @@index([clerkId])
  @@index([status])
  @@index([clerkId, status])
  @@index([createdAt])
  @@index([runpodJobId])
  @@map("training_jobs")
}

model TrainingImage {
  id            String      @id @default(cuid())
  clerkId       String
  trainingJobId String
  filename      String
  caption       String?
  fileSize      Int?
  width         Int?
  height        Int?
  format        String?
  storageUrl    String
  localPath     String?
  uploadedAt    DateTime    @default(now())
  user          User        @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  trainingJob   TrainingJob @relation(fields: [trainingJobId], references: [id], onDelete: Cascade)

  @@unique([trainingJobId, filename])
  @@index([trainingJobId])
  @@index([clerkId])
  @@map("training_images")
}

model ProductionEntry {
  id              String                 @id @default(cuid())
  clerkId         String
  deadline        DateTime
  assignee        String
  influencer      String
  instagramSource String
  loraModel       String
  status          ProductionStatus       @default(PENDING)
  imagesTarget    Int                    @default(0)
  imagesGenerated Int                    @default(0)
  videosTarget    Int                    @default(0)
  videosGenerated Int                    @default(0)
  notes           String?
  createdAt       DateTime               @default(now())
  updatedAt       DateTime               @updatedAt
  user            User                   @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  linkedImages    ProductionEntryImage[]
  linkedVideos    ProductionEntryVideo[]

  @@index([clerkId])
  @@index([status])
  @@index([deadline])
  @@index([assignee])
  @@map("production_entries")
}

model InstagramPost {
  id                String                @id @default(cuid())
  clerkId           String
  driveFileId       String?
  driveFileUrl      String?
  fileName          String
  caption           String                @default("")
  scheduledDate     DateTime?
  status            InstagramPostStatus   @default(DRAFT)
  postType          PostType              @default(POST)
  folder            String
  order             Int                   @default(0)
  mimeType          String?
  createdAt         DateTime              @default(now())
  updatedAt         DateTime              @updatedAt
  rejectedAt        DateTime?
  rejectedBy        String?
  rejectionReason   String?
  commentsCount     Int?
  instagramUrl      String?
  lastMetricsUpdate DateTime?
  likesCount        Int?
  publishedAt       DateTime?
  awsS3Key          String?
  awsS3Url          String?
  originalFolder    String?
  profileId         String?
  pipelineItems     ContentPipelineItem[]
  user              User                  @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  profile           InstagramProfile?     @relation(fields: [profileId], references: [id])
  storySlots        StoryPlanningSlot[]   @relation("StorySlots")
  weeklySlots       WeeklyPlanningSlot[]

  @@index([clerkId])
  @@index([profileId])
  @@index([clerkId, profileId])
  @@index([clerkId, order])
  @@index([status])
  @@index([scheduledDate])
  @@index([driveFileId])
  @@index([awsS3Key])
  @@map("instagram_posts")
}

model Notification {
  id        String           @id @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  link      String?
  metadata  Json?
  read      Boolean          @default(false)
  readAt    DateTime?
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, read])
  @@index([createdAt])
  @@map("notifications")
}

model ProductionEntryImage {
  id                String          @id @default(cuid())
  productionEntryId String
  imageId           String
  createdAt         DateTime        @default(now())
  image             GeneratedImage  @relation(fields: [imageId], references: [id], onDelete: Cascade)
  productionEntry   ProductionEntry @relation(fields: [productionEntryId], references: [id], onDelete: Cascade)

  @@unique([productionEntryId, imageId])
  @@index([productionEntryId])
  @@index([imageId])
  @@map("production_entry_images")
}

model ProductionEntryVideo {
  id                String          @id @default(cuid())
  productionEntryId String
  videoId           String
  createdAt         DateTime        @default(now())
  productionEntry   ProductionEntry @relation(fields: [productionEntryId], references: [id], onDelete: Cascade)
  video             GeneratedVideo  @relation(fields: [videoId], references: [id], onDelete: Cascade)

  @@unique([productionEntryId, videoId])
  @@index([productionEntryId])
  @@index([videoId])
  @@map("production_entry_videos")
}

model MultipartUploadSession {
  id             String   @id @default(cuid())
  sessionId      String   @unique
  clerkId        String
  uploadId       String
  s3Key          String
  uniqueFileName String
  totalParts     Int
  uploadedParts  Json     @default("[]")
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  expiresAt      DateTime

  @@index([sessionId])
  @@index([clerkId])
  @@index([expiresAt])
  @@map("multipart_upload_sessions")
}

model FluxKontextConversation {
  id        String               @id @default(cuid())
  clerkId   String
  title     String?
  createdAt DateTime             @default(now())
  updatedAt DateTime             @updatedAt
  user      User                 @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  messages  FluxKontextMessage[]

  @@index([clerkId])
  @@index([clerkId, updatedAt])
  @@map("flux_kontext_conversations")
}

model FluxKontextMessage {
  id             String                  @id @default(cuid())
  conversationId String
  role           MessageRole
  content        String
  imageData      String?
  createdAt      DateTime                @default(now())
  conversation   FluxKontextConversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  @@index([conversationId])
  @@index([conversationId, createdAt])
  @@map("flux_kontext_messages")
}

model FolderShare {
  id                String          @id @default(cuid())
  folderPrefix      String
  ownerClerkId      String
  sharedWithClerkId String
  permission        SharePermission @default(VIEW)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  sharedBy          String?
  note              String?

  @@unique([folderPrefix, sharedWithClerkId])
  @@index([ownerClerkId])
  @@index([sharedWithClerkId])
  @@index([folderPrefix])
  @@map("folder_shares")
}

model LoRAShare {
  id                String         @id @default(cuid())
  loraId            String
  ownerClerkId      String
  sharedWithClerkId String
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  sharedBy          String?
  note              String?
  lora              InfluencerLoRA @relation(fields: [loraId], references: [id], onDelete: Cascade)

  @@unique([loraId, sharedWithClerkId])
  @@index([ownerClerkId])
  @@index([sharedWithClerkId])
  @@index([loraId])
  @@map("lora_shares")
}

model InstagramProfile {
  id                     String                @id @default(cuid())
  clerkId                String
  name                   String
  description            String?
  instagramUsername      String?
  instagramAccountId     String?
  instagramAccessToken   String?
  instagramTokenExpiry   DateTime?
  isDefault              Boolean               @default(false)
  createdAt              DateTime              @default(now())
  updatedAt              DateTime              @updatedAt
  profileImageUrl        String?
  organizationId         String?
  modelBible             Json?
  isFavorite             Boolean               @default(false)
  tags                   String[]              @default([])
  pageStrategy           String?
  customStrategies       Json?
  customContentTypes     String[]              @default([])
  selectedContentTypes   String[]              @default([])
  status                 String                @default("active")
  type                   String                @default("real")
  metadata               Json?
  captions               Caption[]
  bookmarks              FeedPostBookmark[]    @relation("ProfileBookmarks")
  commentLikes           FeedPostCommentLike[] @relation("ProfileCommentLikes")
  comments               FeedPostComment[]     @relation("ProfileComments")
  postLikes              FeedPostLike[]        @relation("ProfilePostLikes")
  feedPosts              FeedPost[]
  receivedFriendRequests Friendship[]          @relation("ReceivedFriendRequests")
  sentFriendRequests     Friendship[]          @relation("SentFriendRequests")
  linkedLoRAs            InfluencerLoRA[]
  posts                  InstagramPost[]
  groupMemberships       ProfileGroupMember[]
  pinnedBy               ProfilePin[]
  user                   User                  @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  organization           Organization?         @relation(fields: [organizationId], references: [id])

  @@index([clerkId])
  @@index([clerkId, isDefault])
  @@index([organizationId])
  @@index([isFavorite])
  @@index([tags])
  @@map("instagram_profiles")
}

model ProfileGroup {
  id             String               @id @default(cuid())
  organizationId String
  name           String
  color          String?
  icon           String?
  order          Int                  @default(0)
  isCollapsed    Boolean              @default(false)
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  organization   Organization         @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  members        ProfileGroupMember[]

  @@unique([organizationId, name])
  @@index([organizationId])
  @@index([organizationId, order])
  @@map("profile_groups")
}

model ProfileGroupMember {
  id             String           @id @default(cuid())
  profileGroupId String
  profileId      String
  order          Int              @default(0)
  addedAt        DateTime         @default(now())
  group          ProfileGroup     @relation(fields: [profileGroupId], references: [id], onDelete: Cascade)
  profile        InstagramProfile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@unique([profileGroupId, profileId])
  @@index([profileGroupId])
  @@index([profileId])
  @@map("profile_group_members")
}

model ProfilePin {
  id        String           @id @default(cuid())
  userId    String
  profileId String
  order     Int              @default(0)
  pinnedAt  DateTime         @default(now())
  user      User             @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  profile   InstagramProfile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@unique([userId, profileId])
  @@index([userId])
  @@index([profileId])
  @@map("profile_pins")
}

model OnboardingInvitation {
  id               String                 @id @default(cuid())
  token            String                 @unique @default(cuid())
  email            String?
  modelName        String?
  notes            String?
  createdByClerkId String
  organizationId   String?
  expiresAt        DateTime?
  maxUses          Int                    @default(1)
  usedCount        Int                    @default(0)
  isActive         Boolean                @default(true)
  createdAt        DateTime               @default(now())
  lastUsedAt       DateTime?
  ipAddresses      String[]               @default([])
  emailError       String?
  emailSent        Boolean                @default(false)
  emailSentAt      DateTime?
  emailResendCount Int                    @default(0)
  lastEmailSentAt  DateTime?
  resendEmailId    String?
  drafts           ModelOnboardingDraft[]
  createdBy        User                   @relation(fields: [createdByClerkId], references: [clerkId], onDelete: Cascade)

  @@index([token])
  @@index([createdByClerkId])
  @@index([organizationId])
  @@index([isActive])
  @@index([expiresAt])
  @@map("onboarding_invitations")
}

model ModelOnboardingDraft {
  id                   String                @id @default(cuid())
  clerkId              String?
  createdByClerkId     String
  organizationId       String?
  status               OnboardingStatus      @default(DRAFT)
  currentStep          Int                   @default(1)
  completionPercentage Int                   @default(0)
  name                 String?
  description          String?
  instagramUsername    String?
  profileImageUrl      String?
  type                 String?               @default("real")
  age                  String?
  birthday             String?
  location             String?
  nationality          String?
  ethnicity            String?
  occupation           String?
  relationshipStatus   String?
  backstory            String?
  interests            String[]              @default([])
  selectedContentTypes String[]              @default([])
  customContentTypes   String[]              @default([])
  primaryNiche         String?
  feedAesthetic        String?
  commonThemes         String?
  uniqueHook           String?
  platformPricing      Json?
  platforms            Json?
  socials              Json?
  modelBible           Json?
  restrictions         Json?
  schedule             Json?
  internalNotes        String?
  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
  submittedAt          DateTime?
  completedAt          DateTime?
  lastAutoSaveAt       DateTime?
  invitationId         String?
  isPublicSubmission   Boolean               @default(false)
  submitterIp          String?
  createdProfileId     String?
  rejectionReason      String?
  reviewStatus         ReviewStatus?         @default(PENDING)
  reviewedAt           DateTime?
  reviewedBy           String?
  user                 User?                 @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  invitation           OnboardingInvitation? @relation(fields: [invitationId], references: [id])

  @@index([clerkId])
  @@index([createdByClerkId])
  @@index([organizationId])
  @@index([status])
  @@index([invitationId])
  @@index([isPublicSubmission])
  @@index([clerkId, status])
  @@index([reviewStatus])
  @@index([status, reviewStatus])
  @@map("model_onboarding_drafts")
}

model Friendship {
  id                String           @id @default(cuid())
  status            FriendshipStatus @default(PENDING)
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt
  receiverProfileId String
  senderProfileId   String
  receiverProfile   InstagramProfile @relation("ReceivedFriendRequests", fields: [receiverProfileId], references: [id], onDelete: Cascade)
  senderProfile     InstagramProfile @relation("SentFriendRequests", fields: [senderProfileId], references: [id], onDelete: Cascade)

  @@unique([senderProfileId, receiverProfileId])
  @@index([senderProfileId])
  @@index([receiverProfileId])
  @@index([senderProfileId, status])
  @@index([receiverProfileId, status])
  @@map("friendships")
}

model FeedPost {
  id        String             @id @default(cuid())
  userId    String
  caption   String
  createdAt DateTime           @default(now())
  updatedAt DateTime           @updatedAt
  imageUrls String[]
  mediaType String             @default("image")
  profileId String?
  bookmarks FeedPostBookmark[]
  comments  FeedPostComment[]
  likes     FeedPostLike[]
  profile   InstagramProfile?  @relation(fields: [profileId], references: [id])
  user      User               @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([profileId])
  @@index([createdAt])
  @@index([userId, createdAt])
  @@index([profileId, createdAt])
  @@map("feed_posts")
}

model FeedPostLike {
  id        String           @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime         @default(now())
  profileId String
  post      FeedPost         @relation(fields: [postId], references: [id], onDelete: Cascade)
  profile   InstagramProfile @relation("ProfilePostLikes", fields: [profileId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, profileId])
  @@index([postId])
  @@index([userId])
  @@index([profileId])
  @@map("feed_post_likes")
}

model FeedPostComment {
  id              String                @id @default(cuid())
  postId          String
  userId          String
  content         String
  createdAt       DateTime              @default(now())
  updatedAt       DateTime              @updatedAt
  parentCommentId String?
  profileId       String?
  likes           FeedPostCommentLike[]
  parentComment   FeedPostComment?      @relation("CommentReplies", fields: [parentCommentId], references: [id], onDelete: Cascade)
  replies         FeedPostComment[]     @relation("CommentReplies")
  post            FeedPost              @relation(fields: [postId], references: [id], onDelete: Cascade)
  profile         InstagramProfile?     @relation("ProfileComments", fields: [profileId], references: [id])
  user            User                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([userId])
  @@index([profileId])
  @@index([postId, createdAt])
  @@index([parentCommentId])
  @@map("feed_post_comments")
}

model FeedPostCommentLike {
  id        String           @id @default(cuid())
  commentId String
  userId    String
  createdAt DateTime         @default(now())
  profileId String
  comment   FeedPostComment  @relation(fields: [commentId], references: [id], onDelete: Cascade)
  profile   InstagramProfile @relation("ProfileCommentLikes", fields: [profileId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, profileId])
  @@index([commentId])
  @@index([userId])
  @@index([profileId])
  @@map("feed_post_comment_likes")
}

model FeedPostBookmark {
  id        String           @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime         @default(now())
  profileId String
  post      FeedPost         @relation(fields: [postId], references: [id], onDelete: Cascade)
  profile   InstagramProfile @relation("ProfileBookmarks", fields: [profileId], references: [id], onDelete: Cascade)
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, profileId])
  @@index([postId])
  @@index([userId])
  @@index([profileId])
  @@map("feed_post_bookmarks")
}

model MarketplaceModel {
  id             String            @id @default(cuid())
  name           String
  price          Float
  status         MarketplaceStatus @default(AVAILABLE)
  imageUrl       String
  category       String            @default("Premium")
  gallery        String[]          @default([])
  description    String
  included       String[]          @default([])
  usedFor        String[]          @default([])
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  organizationId String?
  organization   Organization?     @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([status])
  @@index([createdAt])
  @@index([organizationId])
  @@map("marketplace_models")
}

model WeeklyPlanningSlot {
  id            String           @id @default(cuid())
  clerkId       String
  profileId     String?
  date          DateTime
  slotType      WeeklySlotType
  slotIndex     Int              @default(0)
  status        WeeklySlotStatus @default(PLANNING)
  linkedPostId  String?
  notes         String?
  hashtags      String[]         @default([])
  trendingAudio String?
  contentIdeas  String?
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  linkedPost    InstagramPost?   @relation(fields: [linkedPostId], references: [id])

  @@unique([clerkId, date, slotType, slotIndex])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([linkedPostId])
  @@map("weekly_planning_slots")
}

model ContentPipelineItem {
  id            String                @id @default(cuid())
  clerkId       String
  contentId     String                @unique
  title         String
  contentType   ContentType
  status        PipelineStatus        @default(IDEA)
  linkedPostId  String?
  notes         String?
  ideaDate      DateTime?
  filmingDate   DateTime?
  editingDate   DateTime?
  reviewDate    DateTime?
  approvedDate  DateTime?
  scheduledDate DateTime?
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  dateCreated   DateTime?
  datePosted    DateTime?
  linkedPost    InstagramPost?        @relation(fields: [linkedPostId], references: [id])
  feedPostSlot  FeedPostPlanningSlot? @relation("FeedPostPipeline")
  reelSlot      ReelPlanningSlot?     @relation("ReelPipeline")
  storySlot     StoryPlanningSlot?

  @@index([clerkId])
  @@index([status])
  @@index([clerkId, status])
  @@index([contentType])
  @@index([linkedPostId])
  @@map("content_pipeline_items")
}

model StoryPlanningSlot {
  id                 String               @id @default(cuid())
  clerkId            String
  profileId          String?
  date               DateTime
  storyType          StoryType
  interactiveElement InteractiveElement?
  linkedPostId       String?
  notes              String?
  caption            String?
  hashtags           String[]             @default([])
  isPosted           Boolean              @default(false)
  postedAt           DateTime?
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt
  awsS3Key           String?
  awsS3Url           String?
  fileName           String?
  mimeType           String?
  contentId          String?              @unique
  pipelineItemId     String?              @unique
  timeSlot           DateTime?
  linkedPost         InstagramPost?       @relation("StorySlots", fields: [linkedPostId], references: [id])
  pipelineItem       ContentPipelineItem? @relation(fields: [pipelineItemId], references: [id])

  @@unique([clerkId, profileId, timeSlot])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([linkedPostId])
  @@index([pipelineItemId])
  @@index([contentId])
  @@map("story_planning_slots")
}

model ReelPlanningSlot {
  id             String               @id @default(cuid())
  clerkId        String
  profileId      String?
  contentId      String?              @unique
  pipelineItemId String?              @unique
  date           DateTime
  timeSlot       DateTime?
  reelType       ReelType
  hookIdea       String?
  trendingAudio  String?
  awsS3Key       String?
  awsS3Url       String?
  fileName       String?
  mimeType       String?
  notes          String?
  caption        String?
  hashtags       String[]             @default([])
  isPosted       Boolean              @default(false)
  postedAt       DateTime?
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  pipelineItem   ContentPipelineItem? @relation("ReelPipeline", fields: [pipelineItemId], references: [id])

  @@unique([clerkId, profileId, timeSlot])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([pipelineItemId])
  @@index([contentId])
  @@map("reel_planning_slots")
}

model FeedPostPlanningSlot {
  id             String               @id @default(cuid())
  clerkId        String
  profileId      String?
  contentId      String?              @unique
  pipelineItemId String?              @unique
  date           DateTime
  timeSlot       DateTime?
  postType       FeedPostType
  caption        String?
  hashtags       String[]             @default([])
  location       String?
  collaborators  String[]             @default([])
  notes          String?
  isPosted       Boolean              @default(false)
  postedAt       DateTime?
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  files          Json?
  pipelineItem   ContentPipelineItem? @relation("FeedPostPipeline", fields: [pipelineItemId], references: [id])

  @@unique([clerkId, profileId, timeSlot])
  @@index([clerkId])
  @@index([profileId])
  @@index([date])
  @@index([clerkId, date])
  @@index([pipelineItemId])
  @@index([contentId])
  @@map("feed_post_planning_slots")
}

model PerformanceMetric {
  id              String   @id @default(cuid())
  clerkId         String
  profileId       String   @default("")
  date            DateTime @db.Date
  reelsPosted     Int      @default(0)
  storiesPosted   Int      @default(0)
  feedPostsPosted Int      @default(0)
  totalViews      Int      @default(0)
  totalLikes      Int      @default(0)
  totalComments   Int      @default(0)
  totalShares     Int      @default(0)
  totalSaves      Int      @default(0)
  storyViews      Int      @default(0)
  storyReplies    Int      @default(0)
  followersStart  Int      @default(0)
  followersEnd    Int      @default(0)
  followersGained Int      @default(0)
  followersLost   Int      @default(0)
  engagementRate  Float?
  averageViews    Float?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@unique([clerkId, date, profileId])
  @@index([clerkId, date])
  @@map("performance_metrics")
}

model WorkflowPhase {
  id          String              @id @default(cuid())
  clerkId     String
  name        String
  description String?
  icon        String              @default("Circle")
  color       String              @default("blue")
  order       Int
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
  profileId   String              @default("")
  items       WorkflowCheckItem[]

  @@index([clerkId])
  @@index([clerkId, profileId])
  @@index([clerkId, order])
  @@map("workflow_phases")
}

model WorkflowCheckItem {
  id        String        @id @default(cuid())
  phaseId   String
  text      String
  order     Int
  checked   Boolean       @default(false)
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
  phase     WorkflowPhase @relation(fields: [phaseId], references: [id], onDelete: Cascade)

  @@index([phaseId])
  @@index([phaseId, order])
  @@map("workflow_check_items")
}

model HashtagSet {
  id          String   @id @default(cuid())
  clerkId     String
  name        String
  category    String
  description String?
  icon        String   @default("Hash")
  color       String   @default("blue")
  hashtags    String[]
  order       Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([clerkId])
  @@index([clerkId, order])
  @@map("hashtag_sets")
}

model VaultFolder {
  id               String             @id @default(cuid())
  clerkId          String
  profileId        String
  name             String
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  isDefault        Boolean            @default(false)
  parentId         String?
  organizationSlug String?
  order            Int                @default(0)
  shares           VaultFolderShare[]
  organization     Organization?      @relation(fields: [organizationSlug], references: [slug])
  parent           VaultFolder?       @relation("FolderHierarchy", fields: [parentId], references: [id], onDelete: Cascade)
  subfolders       VaultFolder[]      @relation("FolderHierarchy")
  items            VaultItem[]

  @@index([clerkId])
  @@index([profileId])
  @@index([clerkId, profileId])
  @@index([parentId])
  @@index([organizationSlug])
  @@map("vault_folders")
}

model VaultFolderShare {
  id                String          @id @default(cuid())
  vaultFolderId     String
  ownerClerkId      String
  sharedWithClerkId String
  permission        SharePermission @default(VIEW)
  sharedBy          String?
  note              String?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  folder            VaultFolder     @relation(fields: [vaultFolderId], references: [id], onDelete: Cascade)

  @@unique([vaultFolderId, sharedWithClerkId])
  @@index([ownerClerkId])
  @@index([sharedWithClerkId])
  @@index([vaultFolderId])
  @@map("vault_folder_shares")
}

model VaultItem {
  id        String      @id @default(cuid())
  clerkId   String
  profileId String
  folderId  String
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  awsS3Key  String
  awsS3Url  String
  fileName  String
  fileSize  Int
  fileType  String
  metadata  Json?
  folder    VaultFolder @relation(fields: [folderId], references: [id], onDelete: Cascade)

  @@index([clerkId])
  @@index([profileId])
  @@index([folderId])
  @@index([clerkId, profileId, folderId])
  @@index([awsS3Key])
  @@map("vault_items")
}

model Caption {
  id                String                 @id @default(cuid())
  clerkId           String
  profileId         String
  caption           String
  captionCategory   String
  captionTypes      String
  captionBanks      String
  usageCount        Int                    @default(0)
  createdAt         DateTime               @default(now())
  updatedAt         DateTime               @updatedAt
  cooldownDays      Int                    @default(7)
  isFavorite        Boolean                @default(false)
  lastUsedAt        DateTime?
  notes             String?
  tags              String?
  originalModelName String?
  totalRevenue      Decimal                @default(0) @db.Decimal(10, 2)
  contentTypes      CaptionToContentType[]
  messageTypes      CaptionToMessageType[]
  profile           InstagramProfile       @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@index([clerkId])
  @@index([profileId])
  @@index([clerkId, profileId])
  @@index([isFavorite])
  @@index([lastUsedAt])
  @@map("captions")
}

model CaptionContentType {
  id        String                 @id @default(cuid())
  name      String                 @unique
  createdAt DateTime               @default(now())
  updatedAt DateTime               @updatedAt
  captions  CaptionToContentType[]

  @@map("caption_content_types")
}

model CaptionMessageType {
  id        String                 @id @default(cuid())
  name      String                 @unique
  createdAt DateTime               @default(now())
  updatedAt DateTime               @updatedAt
  captions  CaptionToMessageType[]

  @@map("caption_message_types")
}

model CaptionToContentType {
  captionId     String
  contentTypeId String
  assignedAt    DateTime           @default(now())
  caption       Caption            @relation(fields: [captionId], references: [id], onDelete: Cascade)
  contentType   CaptionContentType @relation(fields: [contentTypeId], references: [id], onDelete: Cascade)

  @@id([captionId, contentTypeId])
  @@index([captionId])
  @@index([contentTypeId])
  @@map("caption_to_content_types")
}

model CaptionToMessageType {
  captionId     String
  messageTypeId String
  assignedAt    DateTime           @default(now())
  caption       Caption            @relation(fields: [captionId], references: [id], onDelete: Cascade)
  messageType   CaptionMessageType @relation(fields: [messageTypeId], references: [id], onDelete: Cascade)

  @@id([captionId, messageTypeId])
  @@index([captionId])
  @@index([messageTypeId])
  @@map("caption_to_message_types")
}

model CaptionQueueTicket {
  id              String    @id @default(cuid())
  clerkId         String
  profileId       String?
  modelName       String
  modelAvatar     String
  description     String
  urgency         String    @default("medium")
  releaseDate     DateTime
  status          String    @default("pending")
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  assignedTo      String?
  completedAt     DateTime?
  captionText     String?
  contentTypes    String[]  @default([])
  messageTypes    String[]  @default([])
  profileImageUrl String?

  @@index([clerkId])
  @@index([profileId])
  @@index([status])
  @@index([urgency])
  @@index([releaseDate])
  @@index([clerkId, status])
  @@map("caption_queue_tickets")
}

model SextingSet {
  id            String         @id @default(cuid())
  userId        String
  name          String
  category      String
  s3FolderPath  String
  status        String         @default("draft")
  scheduledDate DateTime?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  images        SextingImage[]

  @@index([userId])
  @@index([category])
  @@index([status])
  @@map("sexting_sets")
}

model SextingImage {
  id         String     @id @default(cuid())
  setId      String
  url        String
  name       String
  type       String
  sequence   Int
  size       Int
  uploadedAt DateTime   @default(now())
  set        SextingSet @relation(fields: [setId], references: [id], onDelete: Cascade)

  @@index([setId])
  @@index([sequence])
  @@map("sexting_images")
}

model SubscriptionPlan {
  id              String          @id @default(cuid())
  name            String          @unique
  displayName     String
  description     String?
  price           Float           @default(0)
  billingInterval BillingInterval @default(MONTHLY)
  maxMembers      Int             @default(1)
  maxProfiles     Int             @default(1)
  maxWorkspaces   Int             @default(0)
  maxStorageGB    Int             @default(5)
  monthlyCredits  Int             @default(100)
  stripePriceId   String?         @unique
  stripeProductId String?
  isActive        Boolean         @default(true)
  isPublic        Boolean         @default(true)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @default(now()) @updatedAt
  features        Json            @default("{}")
  organizations   Organization[]
  plan_features   plan_features[]

  @@index([isActive])
  @@index([isPublic])
  @@index([name])
  @@map("subscription_plans")
}

model Organization {
  id                            String                        @id @default(cuid())
  name                          String
  slug                          String                        @unique
  description                   String?
  logoUrl                       String?
  subscriptionPlanId            String?
  subscriptionStatus            SubscriptionStatus            @default(TRIAL)
  trialEndsAt                   DateTime?
  currentPeriodStart            DateTime?
  currentPeriodEnd              DateTime?
  cancelAtPeriodEnd             Boolean                       @default(false)
  stripeCustomerId              String?                       @unique
  stripeSubscriptionId          String?                       @unique
  billingEmail                  String?
  billingName                   String?
  billingAddress                Json?
  customMaxMembers              Int?
  customMaxProfiles             Int?
  customMaxWorkspaces           Int?
  customMaxStorageGB            Int?
  customMonthlyCredits          Int?
  currentStorageGB              Float                         @default(0)
  creditsUsedThisMonth          Int
  lastCreditReset               DateTime?
  isActive                      Boolean                       @default(true)
  createdAt                     DateTime                      @default(now())
  updatedAt                     DateTime                      @default(now()) @updatedAt
  availableCredits              Int                           @default(0)
  additionalMemberSlots         Int                           @default(0)
  memberSlotPrice               Float?
  additionalContentProfileSlots Int                           @default(0)
  contentProfileSlotPrice       Float?
  additionalStorageGB           Int                           @default(0)
  storageSlotPrice              Float?
  transactions                  BillingTransaction[]
  content_submissions           content_submissions[]
  creditUsageLogs               CreditUsageLog[]
  customPermissions             CustomOrganizationPermission?
  gallery_items                 gallery_items[]
  instagramProfiles             InstagramProfile[]
  marketplaceModels             MarketplaceModel[]
  invites                       OrganizationInvite[]
  subscriptionPlan              SubscriptionPlan?             @relation(fields: [subscriptionPlanId], references: [id])
  members                       TeamMember[]
  vaultFolders                  VaultFolder[]
  workspaces                    Workspace[]
  profileGroups                 ProfileGroup[]

  @@index([slug])
  @@index([subscriptionPlanId])
  @@index([stripeCustomerId])
  @@index([isActive])
  @@map("organizations")
}

model TeamMember {
  id               String       @id @default(cuid())
  userId           String
  organizationId   String
  role             TeamRole     @default(MEMBER)
  canInviteMembers Boolean      @default(false)
  canManageBilling Boolean      @default(false)
  canManageMembers Boolean      @default(false)
  lastActiveAt     DateTime?
  invitedBy        String?
  joinedAt         DateTime     @default(now())
  createdAt        DateTime     @default(now())
  updatedAt        DateTime     @default(now()) @updatedAt
  organization     Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user             User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, organizationId])
  @@index([organizationId])
  @@index([userId])
  @@index([organizationId, role])
  @@map("team_members")
}

model OrganizationInvite {
  id             String       @id @default(cuid())
  organizationId String
  email          String
  role           TeamRole     @default(MEMBER)
  invitedBy      String
  token          String       @unique
  expiresAt      DateTime
  acceptedAt     DateTime?
  createdAt      DateTime     @default(now())
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@unique([organizationId, email])
  @@index([organizationId])
  @@index([token])
  @@index([email])
  @@map("organization_invites")
}

model CustomOrganizationPermission {
  id              String       @id @default(cuid())
  organizationId  String       @unique
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @default(now()) @updatedAt
  permissions     Json         @default("{}")
  maxVaultFolders Int?
  organization    Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@map("custom_organization_permissions")
}

model Workspace {
  id             String            @id @default(cuid())
  organizationId String
  name           String
  slug           String
  description    String?
  color          String?
  icon           String?
  isActive       Boolean           @default(true)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @default(now()) @updatedAt
  access         SpaceAccess       @default(OPEN)
  config         Json?
  key            String?
  templateType   SpaceTemplateType @default(KANBAN)
  boards         Board[]
  members        WorkspaceMember[]
  organization   Organization      @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@unique([organizationId, slug])
  @@unique([organizationId, key])
  @@index([organizationId])
  @@index([isActive])
  @@index([templateType])
  @@map("workspaces")
}

model WorkspaceMember {
  id          String    @id @default(cuid())
  workspaceId String
  userId      String
  role        TeamRole  @default(MEMBER)
  joinedAt    DateTime  @default(now())
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @default(now()) @updatedAt
  users       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  workspace   Workspace @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

  @@unique([workspaceId, userId])
  @@index([workspaceId])
  @@index([userId])
  @@map("workspace_members")
}

model Board {
  id          String        @id @default(cuid())
  workspaceId String
  name        String
  description String?
  position    Int           @default(0)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  columns     BoardColumn[]
  workspace   Workspace     @relation(fields: [workspaceId], references: [id], onDelete: Cascade)

  @@index([workspaceId])
  @@index([workspaceId, position])
  @@map("boards")
}

model BoardColumn {
  id        String      @id @default(cuid())
  boardId   String
  name      String
  color     String?
  position  Int         @default(0)
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  board     Board       @relation(fields: [boardId], references: [id], onDelete: Cascade)
  items     BoardItem[]

  @@index([boardId])
  @@index([boardId, position])
  @@map("board_columns")
}

model BoardItem {
  id          String             @id @default(cuid())
  columnId    String
  title       String
  description String?
  type        BoardItemType      @default(TASK)
  priority    BoardItemPriority  @default(MEDIUM)
  assigneeId  String?
  dueDate     DateTime?
  position    Int                @default(0)
  metadata    Json?
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
  createdBy   String?
  comments    BoardItemComment[]
  media       BoardItemMedia[]
  column      BoardColumn        @relation(fields: [columnId], references: [id], onDelete: Cascade)

  @@index([columnId])
  @@index([columnId, position])
  @@index([assigneeId])
  @@index([createdBy])
  @@index([dueDate])
  @@map("board_items")
}

model BoardItemComment {
  id        String    @id @default(cuid())
  itemId    String
  content   String
  createdBy String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  item      BoardItem @relation(fields: [itemId], references: [id], onDelete: Cascade)

  @@index([itemId])
  @@index([createdBy])
  @@index([itemId, createdAt])
  @@map("board_item_comments")
}

model BoardItemMedia {
  id        String    @id @default(cuid())
  itemId    String
  url       String
  type      String
  name      String?
  size      Int?
  createdAt DateTime  @default(now())
  item      BoardItem @relation(fields: [itemId], references: [id], onDelete: Cascade)

  @@index([itemId])
  @@map("board_item_media")
}

model CreditUsageLog {
  id             String       @id @default(cuid())
  organizationId String
  userId         String?
  workspaceId    String?
  action         String
  resource       String
  creditsUsed    Int          @default(0)
  metadata       Json?
  createdAt      DateTime     @default(now())
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user           User?        @relation(fields: [userId], references: [id])

  @@index([organizationId])
  @@index([userId])
  @@index([organizationId, createdAt])
  @@index([createdAt])
  @@map("credit_usage_logs")
}

model BillingTransaction {
  id                      String            @id @default(cuid())
  organizationId          String
  type                    TransactionType
  status                  TransactionStatus @default(PENDING)
  amount                  Float
  currency                String            @default("usd")
  description             String
  stripeInvoiceId         String?
  stripePaymentIntentId   String?
  stripeCheckoutSessionId String?
  creditsAdded            Int?
  planName                String?
  billingPeriodStart      DateTime?
  billingPeriodEnd        DateTime?
  metadata                Json?
  failureReason           String?
  createdAt               DateTime          @default(now())
  updatedAt               DateTime          @updatedAt
  userId                  String?
  organization            Organization      @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user                    User?             @relation(fields: [userId], references: [id])

  @@index([organizationId])
  @@index([organizationId, createdAt])
  @@index([userId])
  @@index([type])
  @@index([status])
  @@index([stripeInvoiceId])
  @@index([createdAt])
  @@map("billing_transactions")
}

model ai_voice_accounts {
  id                   String                 @id
  name                 String
  description          String?
  elevenlabsVoiceId    String                 @unique
  elevenlabsApiKey     String?
  previewUrl           String?
  category             String?
  gender               String?
  age                  String?
  accent               String?
  language             String?
  labels               Json?
  settings             Json?
  isActive             Boolean                @default(true)
  usageCount           Int                    @default(0)
  lastUsedAt           DateTime?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  createdBy            String
  ai_voice_generations ai_voice_generations[]

  @@index([category])
  @@index([createdBy])
  @@index([isActive])
}

model ai_voice_generations {
  id                String            @id
  userId            String
  voiceAccountId    String
  voiceName         String
  text              String
  characterCount    Int
  modelId           String
  outputFormat      String
  audioUrl          String?
  audioSize         Int?
  voiceSettings     Json?
  createdAt         DateTime          @default(now())
  ai_voice_accounts ai_voice_accounts @relation(fields: [voiceAccountId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([userId])
  @@index([voiceAccountId])
}

model reference_items {
  id           String             @id @default(cuid())
  clerkId      String
  name         String
  description  String?
  fileType     String
  mimeType     String
  fileSize     Int
  width        Int?
  height       Int?
  duration     Float?
  awsS3Key     String
  awsS3Url     String
  thumbnailUrl String?
  tags         String[]           @default([])
  usageCount   Int                @default(0)
  lastUsedAt   DateTime?
  createdAt    DateTime           @default(now())
  updatedAt    DateTime           @updatedAt
  folderId     String?
  isFavorite   Boolean            @default(false)
  fileHash     String?
  user         User               @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  folder       reference_folders? @relation(fields: [folderId], references: [id])

  @@index([clerkId])
  @@index([clerkId, folderId])
  @@index([clerkId, isFavorite])
  @@index([fileType])
  @@index([lastUsedAt])
  @@index([folderId])
  @@index([tags])
  @@index([usageCount])
  @@index([clerkId, fileHash])
}

model reference_folders {
  id          String              @id @default(cuid())
  clerkId     String
  name        String
  description String?
  color       String              @default("#8B5CF6")
  icon        String              @default("folder")
  parentId    String?
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
  user        User                @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  parent      reference_folders?  @relation("FolderHierarchy", fields: [parentId], references: [id])
  children    reference_folders[] @relation("FolderHierarchy")
  items       reference_items[]

  @@unique([clerkId, name, parentId])
  @@index([clerkId])
  @@index([clerkId, parentId])
  @@index([parentId])
}

model of_model_assets {
  id           String           @id @default(cuid())
  creatorId    String
  type         OfModelAssetType
  name         String
  url          String
  thumbnailUrl String?
  fileSize     Int?
  mimeType     String?
  metadata     Json?
  createdAt    DateTime         @default(now())
  updatedAt    DateTime
  of_models    of_models        @relation(fields: [creatorId], references: [id], onDelete: Cascade)

  @@index([creatorId])
  @@index([type])
}

model of_model_details {
  id                   String    @id @default(cuid())
  creatorId            String    @unique
  fullName             String?
  age                  Int?
  birthday             DateTime?
  height               String?
  weight               String?
  ethnicity            String?
  timezone             String?
  currentCity          String?
  interests            String[]  @default([])
  favoriteColors       String[]  @default([])
  favoriteEmojis       String[]  @default([])
  contentOffered       String[]  @default([])
  customMinPrice       Float?
  videoCallMinPrice    Float?
  limitations          String[]  @default([])
  verbiageRestrictions String[]  @default([])
  amazonWishlist       String?
  onboardingCompleted  Boolean   @default(false)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  of_models            of_models @relation(fields: [creatorId], references: [id], onDelete: Cascade)

  @@index([creatorId])
}

model of_model_pricing_categories {
  id                     String                   @id @default(cuid())
  creatorId              String?
  name                   String
  slug                   String
  description            String?
  order                  Int                      @default(0)
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  isGlobal               Boolean                  @default(false)
  of_models              of_models?               @relation(fields: [creatorId], references: [id], onDelete: Cascade)
  of_model_pricing_items of_model_pricing_items[]

  @@unique([creatorId, slug])
  @@index([creatorId])
  @@index([isGlobal])
}

model of_model_pricing_items {
  id                          String                      @id @default(cuid())
  categoryId                  String
  name                        String
  price                       Float
  description                 String?
  order                       Int                         @default(0)
  isActive                    Boolean                     @default(true)
  createdAt                   DateTime                    @default(now())
  updatedAt                   DateTime
  isFree                      Boolean                     @default(false)
  priceMax                    Float?
  priceMin                    Float?
  priceType                   PricingItemType             @default(FIXED)
  of_model_pricing_categories of_model_pricing_categories @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  pricing_history             pricing_history[]

  @@index([categoryId])
  @@index([isFree])
  @@index([priceType])
}

model of_models {
  id                          String                        @id @default(cuid())
  name                        String
  displayName                 String
  slug                        String                        @unique
  status                      OfModelStatus                 @default(ACTIVE)
  profileImageUrl             String?
  bio                         String?
  personalityType             String?
  commonTerms                 String[]                      @default([])
  commonEmojis                String[]                      @default([])
  restrictedTerms             String[]                      @default([])
  notes                       String?
  percentageTaken             Float?
  guaranteedAmount            Float?
  launchDate                  DateTime?
  instagramUrl                String?
  twitterUrl                  String?
  tiktokUrl                   String?
  websiteUrl                  String?
  profileLinkUrl              String?
  referrerName                String?
  chattingManagers            String[]                      @default([])
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime
  createdBy                   String?
  contentTypeOptions          ContentTypeOption[]           @relation("ModelContentTypes")
  gallery_items               gallery_items[]
  of_model_assets             of_model_assets[]
  of_model_details            of_model_details?
  of_model_pricing_categories of_model_pricing_categories[]

  @@index([slug])
  @@index([status])
}

model gallery_items {
  id               String        @id @default(cuid())
  organizationId   String?
  previewUrl       String
  thumbnailUrl     String?
  originalAssetUrl String?
  title            String?
  contentType      String
  tags             String[]      @default([])
  platform         String
  pricingAmount    Decimal?      @db.Decimal(10, 2)
  modelId          String?
  pipelineItemId   String?       @unique
  captionUsed      String?
  revenue          Decimal       @default(0) @db.Decimal(12, 2)
  salesCount       Int           @default(0)
  conversionRate   Decimal?      @db.Decimal(5, 4)
  viewCount        Int           @default(0)
  postedAt         DateTime
  origin           String?
  sourceId         String?
  isArchived       Boolean       @default(false)
  archivedAt       DateTime?
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
  createdBy        String?
  model            of_models?    @relation(fields: [modelId], references: [id])
  organization     Organization? @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@index([modelId])
  @@index([contentType])
  @@index([platform])
  @@index([postedAt])
}

model plan_features {
  id                 String           @id
  planId             String
  featureKey         String
  featureValue       String
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @default(now())
  subscription_plans SubscriptionPlan @relation(fields: [planId], references: [id], onDelete: Cascade)

  @@unique([planId, featureKey])
  @@index([featureKey])
  @@index([planId])
}

model pricing_template {
  id          String                  @id @default(cuid())
  name        String
  slug        String                  @unique
  description String?
  category    PricingTemplateCategory
  pageType    PricingTemplatePageType @default(ALL_PAGES)
  isDefault   Boolean                 @default(false)
  isActive    Boolean                 @default(true)
  createdBy   String?
  createdAt   DateTime                @default(now())
  updatedAt   DateTime                @updatedAt
  items       pricing_template_item[]

  @@index([category])
  @@index([pageType])
  @@index([isActive])
}

model pricing_template_item {
  id          String           @id @default(cuid())
  templateId  String
  name        String
  priceType   PricingItemType  @default(FIXED)
  priceFixed  Float?
  priceMin    Float?
  priceMax    Float?
  description String?
  order       Int              @default(0)
  isActive    Boolean          @default(true)
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  isFree      Boolean          @default(false)
  template    pricing_template @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@index([templateId])
  @@index([order])
  @@index([isFree])
}

model pricing_history {
  id            String                 @id @default(cuid())
  pricingItemId String
  changeType    PricingChangeType
  oldName       String?
  oldPriceType  PricingItemType?
  oldPrice      Float?
  oldPriceMin   Float?
  oldPriceMax   Float?
  oldIsFree     Boolean?
  oldIsActive   Boolean?
  newName       String?
  newPriceType  PricingItemType?
  newPrice      Float?
  newPriceMin   Float?
  newPriceMax   Float?
  newIsFree     Boolean?
  newIsActive   Boolean?
  changedById   String?
  changedByName String?
  reason        String?
  createdAt     DateTime               @default(now())
  pricingItem   of_model_pricing_items @relation(fields: [pricingItemId], references: [id], onDelete: Cascade)

  @@index([pricingItemId])
  @@index([createdAt])
  @@index([changeType])
  @@index([changedById])
}

model FeatureCreditPricing {
  id          String   @id @default(cuid())
  featureKey  String   @unique
  featureName String
  category    String
  credits     Int
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([featureKey])
  @@index([category])
  @@index([isActive])
  @@map("feature_credit_pricing")
}

model content_submission_files {
  id                  String              @id
  submissionId        String
  awsS3Key            String
  awsS3Url            String
  awsS3Bucket         String?
  fileName            String
  fileSize            Int
  fileType            String
  fileCategory        String
  width               Int?
  height              Int?
  duration            Float?
  thumbnailUrl        String?
  uploadStatus        String              @default("pending")
  uploadError         String?
  order               Int                 @default(0)
  uploadedBy          String?
  uploadedAt          DateTime            @default(now())
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  content_submissions content_submissions @relation(fields: [submissionId], references: [id], onDelete: Cascade)

  @@index([awsS3Key])
  @@index([fileCategory])
  @@index([submissionId])
  @@index([submissionId, order])
  @@index([uploadStatus])
}

model content_submission_pricing {
  id                  String              @id
  submissionId        String              @unique
  minimumPrice        Float?
  suggestedPrice      Float?
  finalPrice          Float?
  currency            String              @default("usd")
  pricingType         String?
  priceRangeMin       Float?
  priceRangeMax       Float?
  pricingNotes        String?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  content_submissions content_submissions @relation(fields: [submissionId], references: [id], onDelete: Cascade)

  @@index([minimumPrice])
  @@index([submissionId])
}

model content_submission_release_schedules {
  id                  String              @id
  submissionId        String              @unique
  releaseDate         DateTime
  releaseTime         String?
  timezone            String              @default("UTC")
  releaseDateTime     DateTime?
  isScheduled         Boolean             @default(true)
  scheduledBy         String?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  content_submissions content_submissions @relation(fields: [submissionId], references: [id], onDelete: Cascade)

  @@index([releaseDateTime])
  @@index([releaseDate])
  @@index([submissionId])
}

model content_submissions {
  id                                   String                                @id
  organizationId                       String
  clerkId                              String
  submissionType                       String
  contentStyle                         String
  status                               SubmissionStatus                      @default(DRAFT)
  modelId                              String?
  modelName                            String?
  priority                             String                                @default("normal")
  caption                              String?
  driveLink                            String?
  contentType                          String?
  contentCount                         String?
  contentLength                        String?
  contentTags                          String[]                              @default([])
  externalCreatorTags                  String?
  internalModelTags                    String[]                              @default([])
  platform                             String?                               @default("onlyfans")
  notes                                String?
  metadata                             Json?
  createdAt                            DateTime                              @default(now())
  updatedAt                            DateTime
  pricingCategory                      String?                               @default("PORN_ACCURATE")
  contentTypeOptionId                  String?
  content_submission_files             content_submission_files[]
  content_submission_pricing           content_submission_pricing?
  content_submission_release_schedules content_submission_release_schedules?
  users                                User                                  @relation(fields: [clerkId], references: [clerkId], onDelete: Cascade)
  contentTypeOption                    ContentTypeOption?                    @relation("SubmissionContentType", fields: [contentTypeOptionId], references: [id])
  organizations                        Organization                          @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([clerkId])
  @@index([contentStyle])
  @@index([createdAt])
  @@index([organizationId, clerkId])
  @@index([organizationId])
  @@index([organizationId, status])
  @@index([pricingCategory])
  @@index([status])
  @@index([submissionType])
}

model ContentTypeOption {
  id             String                      @id @default(cuid())
  value          String
  label          String
  priceType      String?
  priceFixed     Float?
  priceMin       Float?
  priceMax       Float?
  description    String?
  isActive       Boolean                     @default(true)
  order          Int                         @default(0)
  createdAt      DateTime                    @default(now())
  updatedAt      DateTime                    @updatedAt
  category       String
  isFree         Boolean                     @default(false)
  modelId        String?
  pageType       String?                     @default("ALL_PAGES")
  model          of_models?                  @relation("ModelContentTypes", fields: [modelId], references: [id], onDelete: Cascade)
  pricingHistory ContentTypePricingHistory[] @relation("ContentTypePricingHistory")
  submissions    content_submissions[]       @relation("SubmissionContentType")

  @@index([isActive])
  @@index([order])
  @@index([category])
  @@index([isFree])
  @@index([modelId])
  @@index([pageType])
  @@index([value, category, modelId, pageType])
}

model ContentTypePricingHistory {
  id                  String            @id @default(cuid())
  contentTypeOptionId String
  changeType          String
  oldPriceType        String?
  oldPriceFixed       Float?
  oldPriceMin         Float?
  oldPriceMax         Float?
  oldLabel            String?
  oldIsFree           Boolean?
  newPriceType        String?
  newPriceFixed       Float?
  newPriceMin         Float?
  newPriceMax         Float?
  newLabel            String?
  newIsFree           Boolean?
  changedById         String?
  reason              String?
  createdAt           DateTime          @default(now())
  contentTypeOption   ContentTypeOption @relation("ContentTypePricingHistory", fields: [contentTypeOptionId], references: [id], onDelete: Cascade)

  @@index([contentTypeOptionId])
  @@index([createdAt])
}

enum SpaceAccess {
  OPEN
  PRIVATE
}

enum SpaceTemplateType {
  KANBAN
  WALL_POST
  SEXTING_SETS
  OTP_PTR
}

enum BoardItemType {
  TASK
  POST
  REQUEST
  SET
  NOTE
}

enum BoardItemPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum SyncStatus {
  PENDING
  SYNCED
  MISSING
  ERROR
}

enum JobStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum TrainingStatus {
  PENDING
  QUEUED
  INITIALIZING
  PROCESSING
  SAMPLING
  SAVING
  COMPLETED
  FAILED
  CANCELLED
  TIMEOUT
}

enum GenerationType {
  TEXT_TO_IMAGE
  IMAGE_TO_VIDEO
  IMAGE_TO_IMAGE
  TEXT_TO_VIDEO
  VIDEO_TO_VIDEO
  SKIN_ENHANCEMENT
  IMAGE_TO_IMAGE_SKIN_ENHANCEMENT
  FACE_SWAP
  VIDEO_FPS_BOOST
  FLUX_KONTEXT
  KLING_TEXT_TO_VIDEO
  KLING_IMAGE_TO_VIDEO
  KLING_MULTI_IMAGE_TO_VIDEO
  KLING_MOTION_CONTROL
}

enum UserRole {
  USER
  ADMIN
  SUPER_ADMIN
}

enum ProductionStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
}

enum InstagramPostStatus {
  DRAFT
  REVIEW
  APPROVED
  SCHEDULED
  PUBLISHED
  PENDING
}

enum NotificationType {
  POST_REMINDER
  POST_APPROVED
  POST_REJECTED
  SYSTEM
}

enum PostType {
  POST
  REEL
  STORY
}

enum SharePermission {
  VIEW
  EDIT
}

enum MessageRole {
  USER
  ASSISTANT
  SYSTEM
}

enum FriendshipStatus {
  PENDING
  ACCEPTED
  REJECTED
  BLOCKED
}

enum MarketplaceStatus {
  AVAILABLE
  SOLD
  RESERVED
}

enum WeeklySlotType {
  REEL_1
  REEL_2
  STORY_BATCH
  FEED_POST
}

enum WeeklySlotStatus {
  PLANNING
  IN_PROGRESS
  READY
  ASSIGNED
  POSTED
}

enum ContentType {
  REEL
  POST
  STORY
  CAROUSEL
  VIDEO
}

enum PipelineStatus {
  IDEA
  FILMING
  EDITING
  REVIEW
  APPROVED
  SCHEDULED
  POSTED
  ARCHIVED
}

enum StoryTimeSlot {
  SLOT_9AM
  SLOT_11AM
  SLOT_1PM
  SLOT_3PM
  SLOT_5PM
  SLOT_7PM
  SLOT_9PM
  SLOT_OTHER
}

enum StoryType {
  SELFIE
  BEHIND_SCENES
  PROMO
  PRODUCT
  GRWM
  OOTD
  QA
  TUTORIAL
  LIFESTYLE
  ANNOUNCEMENT
  USER_CONTENT
  OTHER
}

enum InteractiveElement {
  POLL
  SLIDER
  QUESTION
  QUIZ
  COUNTDOWN
  LINK
  MENTION
  HASHTAG
  LOCATION
  MUSIC
  NONE
}

enum ReelType {
  TRENDING
  TUTORIAL
  BEHIND_SCENES
  PROMO
  PRODUCT
  LIFESTYLE
  TRANSITION
  DAY_IN_LIFE
  CHALLENGE
  COMEDY
  EDUCATIONAL
  OTHER
}

enum FeedPostType {
  SINGLE_IMAGE
  CAROUSEL
  VIDEO
  ALBUM
}

enum BillingInterval {
  MONTHLY
  YEARLY
  DAILY
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  PAST_DUE
  CANCELLED
  EXPIRED
  PAUSED
}

enum TeamRole {
  OWNER
  ADMIN
  MANAGER
  CREATOR
  VIEWER
  MEMBER
}

enum ReferenceType {
  IMAGE
  VIDEO
}

enum OfModelAssetType {
  IMAGE
  VIDEO
  DOCUMENT
  AUDIO
  OTHER
}

enum OfModelStatus {
  ACTIVE
  INACTIVE
  DROPPED
  PENDING
}

enum PricingChangeType {
  CREATED
  UPDATED
  DELETED
  ACTIVATED
  DEACTIVATED
  PRICE_CHANGE
}

enum PricingTemplateCategory {
  PORN_ACCURATE
  PORN_SCAM
  GF_ACCURATE
  GF_SCAM
  BUNDLE_BASED
  CUSTOM
}

enum PricingTemplatePageType {
  ALL_PAGES
  FREE
  PAID
  VIP
}

enum PricingItemType {
  FIXED
  RANGE
  MINIMUM
}

enum TransactionStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
  CANCELLED
}

enum TransactionType {
  SUBSCRIPTION_PAYMENT
  SUBSCRIPTION_REFUND
  CREDIT_PURCHASE
  CREDIT_REFUND
  PLAN_CHANGE
}

enum SubmissionStatus {
  DRAFT
  SUBMITTED
  IN_REVIEW
  APPROVED
  REJECTED
  PUBLISHED
}

enum OnboardingStatus {
  DRAFT
  IN_PROGRESS
  AWAITING_REVIEW
  COMPLETED
  CANCELLED
}

enum ReviewStatus {
  PENDING
  APPROVED
  REJECTED
  CHANGES_REQUESTED
}
